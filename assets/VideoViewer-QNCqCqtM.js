import{aH as w,r as s,ck as S,aJ as t,cl as j,aL as V}from"./index-BxFApyUW.js";import{g as A}from"./videos-Cpt3khts.js";import{A as F,V as q}from"./VideoWithMuted-Cup6aGIT.js";import{S as z,T as p,t as M,a3 as T}from"./MyApp-BkDc7srk.js";function B({info:l,style:C,videoStyle:E,buttonTop:d=!1}){const{ti:f}=w(),[i,h]=s.useState(null),[r,L]=s.useState({}),[m,R]=s.useState(0),[n,g]=s.useState(!1),[o,k]=s.useState(l),a=(o==null?void 0:o.variants)||[],c=(i==null?void 0:i.source)||(o==null?void 0:o.source);s.useEffect(()=>{!l.source&&l.id&&(g(!0),A(l.id).then(e=>{k(e)}).finally(()=>{g(!1)}))},[l.source,l.id]);const u=s.useRef(!1);s.useEffect(()=>{a!=null&&a.length&&!Object.keys(r).length&&!u.current&&(u.current=!0,Promise.all(a.map(e=>S(e.source).then(y=>{L(b=>({...b,[e.id]:y}))}).catch(()=>{console.log("ERROR get size",e)}))).finally(()=>{u.current=!1}))},[r,a]),s.useEffect(()=>{c&&S(c).then(e=>{R(e)})},[c]);const x=t.jsxs(z.Compact,{children:[t.jsx(p,{title:m?j(m,1):"",children:t.jsx(V,{type:i?"default":"primary",onClick:()=>h(null),children:f({en:"Default",vi:"Mặc định"})})}),a==null?void 0:a.map((e,y)=>t.jsx(p,{title:(e.isAudio?"":e.width+"x"+e.height)+(r[e.id]?" - "+j(r[e.id],1):""),children:t.jsxs(V,{type:(i==null?void 0:i.id)===e.id?"primary":"default",onClick:()=>{M("VideoViewer:onChangeVariant:"+(e.qualityLabel||e.mimeType)),h(e)},icon:e.isAudio?t.jsx("i",{className:"fa-solid fa-music"}):null,children:[e.qualityClass," ",e.qualityLabel||e.mimeType]})},e.id))]});return t.jsxs(z,{direction:"vertical",style:{padding:15,borderRadius:10,backgroundColor:"#222",justifyContent:"center",alignItems:"center",...C},children:[!n&&d&&x,n?t.jsx(T,{tip:f({en:"Loading video...",vi:"Đang tải video..."}),children:t.jsx("div",{style:{width:150,height:50}})}):i!=null&&i.isAudio?t.jsx(F,{src:c}):t.jsx(q,{src:c,style:{maxWidth:"80vw",maxHeight:"80vh",...E}}),!n&&!d&&x]})}export{B as default};
