const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./VideoViewer-DCrkG1_V.js","./index-CsQMy14F.js","./index-9SBFHPtm.css","./videos-B_5hRemn.js","./MyApp-DnJEb2pA.js","./VideoWithMuted-BvvRpI8j.js","./PostMediaset-CHAj-0On.js","./Collection-HsjKZwIL.js","./index-DBdoTHs6.js","./file-download-CRneYEGd.js","./index-g2iOrP0o.js","./Dropdown-T0PZ1LmY.js","./PurePanel-DI5D6CFd.js","./index-BTyXMOJz.js","./index-BM1pPPhJ.js","./index-BmSnljIR.js","./EyeOutlined-Cb8FaTdA.js","./SearchOutlined-CqGKY-kh.js","./index-BkdUpAfZ.js","./Pagination-DKxVYLvV.js","./useBreakpoint-Cpuu8BlP.js","./responsiveObserver-D7pXVsDA.js","./index-DeiB9NpS.js","./row-DIL6LaJF.js","./index-lxS6W_4b.js","./icons-B-QwQuzx.js","./index-FT9437WK.js"])))=>i.map(i=>d[i]);
import{aH as J,b1 as G,r as D,b8 as O,aJ as t,bl as I,ba as Y,b0 as Z,aL as u,b9 as ee,$ as A,aS as E,b6 as j}from"./index-CsQMy14F.js";import{b as te,d as _,P as k,t as m,S as g,e as ne,g as ie,B,C as N,T as h,a as se,D as F,i as oe,f as ae,E as re}from"./MyApp-DnJEb2pA.js";import{d as le}from"./dayjs.min-DTLJQMty.js";import ce from"./MyTable-lzVk0Na2.js";import{E as de}from"./ExportButton-DxX7Pulo.js";import{u as he}from"./useAction-CfI3qnZk.js";import{A as me}from"./index-BTqlIWlb.js";import{I as R}from"./index-Cx_qBVxI.js";import{C as ge}from"./index-D6F2_0So.js";import{T as p}from"./index-BmSnljIR.js";import{P as xe}from"./index-BsVXmq4I.js";import{R as ue}from"./row-DIL6LaJF.js";import{I as pe}from"./index-BM1pPPhJ.js";import{D as ye}from"./index-BlW0obsU.js";import{S as P}from"./index-DeiB9NpS.js";import"./index-DBdoTHs6.js";import"./Table-BTgZ_Obx.js";import"./addEventListener-CtwiUggX.js";import"./index-BTyXMOJz.js";import"./index-g2iOrP0o.js";import"./Dropdown-T0PZ1LmY.js";import"./PurePanel-DI5D6CFd.js";import"./useBreakpoint-Cpuu8BlP.js";import"./responsiveObserver-D7pXVsDA.js";import"./Pagination-DKxVYLvV.js";import"./SearchOutlined-CqGKY-kh.js";import"./file-download-CRneYEGd.js";import"./index-B-0abWd7.js";import"./EyeOutlined-Cb8FaTdA.js";import"./index-p9STU9fV.js";const ve=A.lazy(()=>E(()=>import("./VideoViewer-DCrkG1_V.js"),__vite__mapDeps([0,1,2,3,4,5]),import.meta.url)),fe=A.lazy(()=>E(()=>import("./PostMediaset-CHAj-0On.js"),__vite__mapDeps([6,1,2,7,8,9,4,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,3,25,5,26]),import.meta.url));function Je(){const{ti:s}=J(),{message:v}=te(),M=G();he();const[x,f]=_("MyPosts.postFilters",{uid:"",privacy:k.ALL,omitPinnedPost:!1,beforeTime:null,taggedInOnly:!1,postedByOthers:null}),[y,w]=_("MyPosts.posts",[]),[L,C]=_("MyPosts.loading",!1),U=D.useMemo(()=>y.map((n,e)=>({...n,recent:e})),[y]);D.useEffect(()=>{m("Posts:onLoad")},[]);const V=async()=>{m("Posts:onClickReload"),C(!0);const n=await F(x);n.length?(w(n),console.log(n)):v.info(s({en:"No data found",vi:"KhÃ´ng cÃ³ dá»¯ liá»‡u"})),C(!1)},S=async()=>{var e;m("Posts:onClickLoadMore"),C(!0);const n=await F({...x,cursor:(e=y[y.length-1])==null?void 0:e.cursor});n!=null&&n.length?(w(o=>[...o,...n]),console.log(n),v.success({content:s({en:"Load more success ",vi:"Táº£i thÃªm thÃ nh cÃ´ng "})+n.length})):v.info({content:s({en:"No more data",vi:"KhÃ´ng cÃ³ dá»¯ liá»‡u"})}),C(!1)},W=(n,e)=>{m("Posts:onChangeTime"),f(o=>j(o,i=>{const a=Array.isArray(e)?e[0]:e;i.beforeTime=new Date(a).getTime(),console.log(e,i.beforeTime)}))},z=n=>{m("Posts:onChangePostedBy:"+n),f(e=>j(e,o=>{o.postedByOthers=n}))},X=n=>{m("Posts:onChangePrivacy:"+n),f(e=>j(e,o=>{o.privacy=n}))},q=()=>{m("Posts:onToggleTaggedOnly"),f(n=>j(n,e=>{e.taggedInOnly=!e.taggedInOnly}))},H=async n=>{const e=n.target.value;if(m("Posts:onChangeUid:"+e),f(o=>j(o,i=>{i.uid=e})),!/^\d+$/.test(e)){const o=await oe(e);f(i=>j(i,a=>{a.uid=o}))}},$=async(n,e=!0)=>{if(e&&!await ae())return!1;const o="Posts:onDeletePost";m(o);const i=o+":"+n.id;return v.loading({key:i,content:s({en:"Deleting post..",vi:"Äang xoÃ¡ bÃ i viáº¿t.."}),duration:0}),await re(n.story_id)?(v.success({key:i,content:s({en:"Post deleted",vi:"XoÃ¡ bÃ i viáº¿t thÃ nh cÃ´ng"})}),w(r=>r.filter(l=>l.story_id!==n.story_id)),!0):(v.error({key:i,content:s({en:"Post not deleted",vi:"KhÃ´ng xoÃ¡ Ä‘Æ°á»£c bÃ i viáº¿t"})}),!1)},K=[{title:"#",key:"recent",dataIndex:"recent",sorter:(n,e)=>n.recent-e.recent,render:(n,e,o)=>e.recent+1,width:70,align:"center"},{title:s({en:"Actor",vi:"NgÆ°á»i Ä‘Äƒng"}),key:"actor",dataIndex:"actor",onSearch:(n,e,o)=>{var i,a;return O(n,(i=o==null?void 0:o.actor)==null?void 0:i.name)||O(n,(a=o==null?void 0:o.actor)==null?void 0:a.id)},render:(n,e,o)=>{var i,a,r,l,c,d;return t.jsxs(g,{style:{maxWidth:300},children:[t.jsx(me,{shape:"square",src:t.jsx(R,{src:ne((i=e.actor)==null?void 0:i.id),fallback:(a=e.actor)==null?void 0:a.avatar}),size:50}),t.jsxs(g,{direction:"vertical",size:0,children:[t.jsx("a",{href:((r=e.actor)==null?void 0:r.url)||ie((l=e.actor)==null?void 0:l.id),target:"_blank",children:t.jsx("b",{children:(c=e.actor)==null?void 0:c.name})}),t.jsx("span",{style:{opacity:.5},children:(d=e.actor)==null?void 0:d.id})]})]})},width:250},{title:s({en:"Media",vi:"áº¢nh/Video"}),key:"media",dataIndex:"media",render:(n,e,o)=>{var c,d;const i=(c=e.content)==null?void 0:c.attachments,a=((d=i==null?void 0:i[0])==null?void 0:d.total_count)||(i==null?void 0:i.length),r=i.length===1,l=i.length===1&&i[0].type==="Video";return(i==null?void 0:i.length)>0?t.jsx(B.Ribbon,{text:l?t.jsx("i",{className:"fa-solid fa-video"}):a,style:{display:l||i.length>1?"block":"none"},children:t.jsx(R,{src:i[0].thumbnail,style:{objectFit:"cover",height:150,width:210,borderRadius:10},preview:r&&!l?!0:{destroyOnClose:!0,imageRender:()=>l?t.jsx(ve,{info:{id:i[0].id}}):t.jsx(ge,{style:{maxWidth:"90vw",maxHeight:"90vh",alignItems:"center",overflowY:"auto",overflowX:"hidden",padding:20,borderRadius:10},children:t.jsx(fe,{target:e.actor,postId:e.url})}),toolbarRender:()=>null}})}):"-"},filters:[{text:s({en:"Video",vi:"Video"}),value:"video"},{text:s({en:"Has media",vi:"CÃ³ áº£nh hoáº·c video"}),value:"has-media"},{text:s({en:"Multi media",vi:"Nhiá»u áº£nh/video"}),value:"multi-media"}],onFilter:(n,e)=>{var o,i,a,r,l,c,d,b,T;if(n==="video")return((i=(o=e.content)==null?void 0:o.attachments)==null?void 0:i.length)===1&&((l=(r=(a=e.content)==null?void 0:a.attachments)==null?void 0:r[0])==null?void 0:l.type)==="Video";if(n==="has-media")return((d=(c=e.content)==null?void 0:c.attachments)==null?void 0:d.length)>0;if(n==="multi-media")return((T=(b=e.content)==null?void 0:b.attachments)==null?void 0:T.length)>1},width:200,align:"right"},{title:s({en:"Content",vi:"Ná»™i dung"}),key:"content",dataIndex:"content",onSearch:(n,e,o)=>{var i;return[(i=o.content)==null?void 0:i.text,o.message,o.title,o.summary].filter(Boolean).some(a=>O(n,a))},render:(n,e,o)=>{var a,r,l,c,d,b;const i=((a=e.content)==null?void 0:a.text)||((c=(l=(r=e.content)==null?void 0:r.attachments)==null?void 0:l.find(T=>T.title))==null?void 0:c.title);return t.jsxs(g,{direction:"vertical",style:{maxWidth:400},children:[e.is_pinned&&t.jsx(B,{count:s({en:"Pinned post",vi:"BÃ i viáº¿t ÄÃ£ ghim"}),color:"green"}),((d=e.summary)==null?void 0:d.length)>0&&t.jsx(p.Text,{style:{fontStyle:"italic"},type:"secondary",children:I(e.summary,150)}),((b=e.message)==null?void 0:b.length)>0&&t.jsx(p.Text,{children:I(e.message,150)}),t.jsx(p.Text,{type:"secondary",children:I(i,150)})]})},width:"auto"},{title:s({en:"Posted time",vi:"ÄÄƒng lÃºc"}),key:"date",dataIndex:"date",sorter:(n,e)=>n.creation_time-e.creation_time,render:(n,e,o)=>t.jsxs(g,{direction:"vertical",size:0,children:[t.jsxs(p.Text,{children:[Y(new Date(e.creation_time))," ",s({en:" ago",vi:"trÆ°á»›c"})]}),t.jsx(p.Text,{type:"secondary",children:Z(e.creation_time)})]})},{title:s({en:"Privacy",vi:"Quyá»n riÃªng tÆ°"}),key:"privacy",dataIndex:"privacy",render:(n,e,o)=>{const i=e.privacy.scope,a=e.privacy.description;return t.jsxs(g,{direction:"vertical",size:0,children:[t.jsx(p.Text,{children:s(N[i])}),a&&i===k.CUSTOM&&t.jsx(p.Text,{type:"secondary",children:a})]})},filters:Object.keys(k).map(n=>({text:s(N[n])+" ("+y.filter(e=>e.privacy.scope===n).length+")",value:n})),onFilter:(n,e)=>e.privacy.scope===n,width:150},{title:s({en:"Action",vi:"HÃ nh Ä‘á»™ng"}),key:"action",dataIndex:"action",render:(n,e,o)=>t.jsxs(g.Compact,{children:[e.can_delete&&t.jsx(h,{title:s({en:"Delete",vi:"XoÃ¡"}),children:t.jsx(xe,{title:s({en:"Are you sure to delete this post?",vi:"Báº¡n cÃ³ cháº¯c muá»‘n xoÃ¡ bÃ i viáº¿t nÃ y?"}),onConfirm:()=>{$(e)},children:t.jsx(u,{icon:t.jsx("i",{className:"fa-solid fa-trash"})})})}),t.jsx(h,{title:s({en:"Open in Bulk downloader",vi:"Má»Ÿ trong Táº£i hÃ ng loáº¡t"}),children:t.jsx(u,{onClick:()=>{M("/bulk-downloader",{state:{targetId:e.url,platform:ee.Facebook}})},icon:t.jsx("i",{className:"fa-solid fa-download"})})}),t.jsx(h,{title:s({en:"View on Facebook",vi:"Xem bÃ i viáº¿t"}),children:t.jsx(u,{onClick:()=>window.open(e.url,"_blank"),icon:t.jsx("i",{className:"fa-solid fa-up-right-from-square"})})})]}),width:150}],Q=n=>{const e=n!=null&&n.length?n:y,o=e.filter(a=>a.can_delete),i=e.filter(a=>{var r;return(r=a.privacy)==null?void 0:r.can_edit});return t.jsxs(t.Fragment,{children:[t.jsxs(g.Compact,{children:[t.jsx(u,{loading:L,icon:t.jsx("i",{className:"fa-solid fa-play"}),onClick:S,children:s(L?{en:"Loading..",vi:"Äang táº£i.."}:{en:"Load more",vi:"Táº£i thÃªm"})}),t.jsx(de,{data:n.length?n:y,options:[{key:"json",label:".json",prepareData:a=>({fileName:"posts.json",data:JSON.stringify(a,null,4)})}]})]}),t.jsxs(g.Compact,{children:[o.length>0&&t.jsx(h,{title:s({en:"Coming soon",vi:"Sáº¯p cÃ³"}),children:t.jsxs(u,{disabled:!0,danger:!0,icon:t.jsx("i",{className:"fa-solid fa-trash"}),children:[s({en:"Delete",vi:"XoÃ¡"})," ",o.length]})}),i.length>0&&t.jsx(h,{title:s({en:"Coming soon",vi:"Sáº¯p cÃ³"}),children:t.jsxs(u,{disabled:!0,icon:t.jsx("i",{className:"fa-solid fa-lock"}),children:[s({en:"Change privacy",vi:"Sá»­a quyá»n riÃªng tÆ°"})," ",i.length]})})]})]})};return t.jsxs("div",{style:{display:"flex",flexDirection:"column",width:"100%",height:"100%"},children:[t.jsxs(ue,{align:"middle",style:{margin:"16px"},children:[t.jsx(p.Title,{level:3,style:{margin:0},children:s({en:"Posts manager",vi:"Quáº£n lÃ½ bÃ i viáº¿t"})}),t.jsx(se,{color:"error",style:{marginLeft:10},children:s({en:"ðŸš§ Work in progress",vi:"ðŸš§ Äang phÃ¡t triá»ƒn"})})]}),t.jsxs(g.Compact,{style:{marginBottom:10,marginLeft:5},children:[t.jsx(h,{title:s({en:"FB User",vi:"NgÆ°á»i dÃ¹ng FB"}),children:t.jsx(pe,{placeholder:s({en:"UID/URL",vi:"UID/URL"}),value:x.uid,onChange:H,style:{maxWidth:150}})}),t.jsx(h,{title:s({en:"Posted before time",vi:"ÄÄƒng trÆ°á»›c ngÃ y"}),children:t.jsx(ye,{value:x.beforeTime?le(x.beforeTime):null,onChange:W})}),t.jsx(h,{title:s({en:"Posted by",vi:"ÄÄƒng bá»Ÿi"}),children:t.jsxs(P,{style:{minWidth:120},value:x.postedByOthers,onChange:z,children:[t.jsx(P.Option,{value:null,children:s({en:"All",vi:"Táº¥t cáº£"})}),t.jsxs(P.Option,{value:!1,children:["ðŸ“Œ ",s({en:"Owner",vi:"ChÃ­nh chá»§"})]}),t.jsxs(P.Option,{value:!0,children:["ðŸ‘¤ ",s({en:"Others",vi:"NgÆ°á»i khÃ¡c"})]})]})}),t.jsx(h,{title:s({en:"Privacy",vi:"Quyá»n riÃªng tÆ°"}),children:t.jsx(P,{style:{minWidth:120},value:x.privacy,onChange:X,children:Object.keys(k).map(n=>t.jsx(P.Option,{value:n,children:s(N[n])},n))})}),t.jsx(h,{title:s({en:"Tagged only",vi:"Chá»‰ bÃ i viáº¿t Ä‘Æ°á»£c gáº¯n tháº»"}),children:t.jsx(u,{icon:t.jsx("i",{className:"fa-solid fa-user-tag"}),type:x.taggedInOnly?"primary":"default",onClick:q,children:s({en:"Tagged only",vi:"Gáº¯n tháº»"})})}),t.jsx(u,{type:"primary",onClick:V,icon:t.jsx("i",{className:"fa-solid fa-filter"}),children:s({en:"Apply",vi:"Lá»c"})})]}),t.jsx(ce,{data:U,columns:K,searchable:!0,selectable:!0,keyExtractor:n=>n.id,renderTitle:Q})]})}export{Je as default};
