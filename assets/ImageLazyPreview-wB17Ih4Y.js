import{av as L,aG as h,r as m,aI as I}from"./index-CKHJa6H8.js";import{f as k,s as x}from"./MyApp-DmnFYXMb.js";import{I as C}from"./index-D6_9vR6G.js";import"./EyeOutlined-CgV8UoEr.js";import"./addEventListener-CyIGRBLo.js";function A(g){const{cacheId:p,getPreview:d,renderPreview:s,...a}=g,{message:n}=L.useApp(),{ti:c}=h(),r=a.src||"",o="ImageLazyPreview."+(p||r),[y,i]=m.useState(!1),[l,u]=m.useState(k(o,"")),v=async()=>{if(!l)try{i(!0),n.loading({duration:0,key:o,content:c({en:"Loading...",vi:"Đang tải..."})});let t=performance.now();const e=await d();let w=performance.now();console.log("getPreview",w-t),e&&e!==r&&(u(e),x(o,e)),n.destroy(o)}catch(t){console.error(t),n.error({key:o,content:c({en:"Load failed: ",vi:"Load lỗi: "})+t.message})}finally{i(!1)}},f=l||r;return I.jsx(C,{...a,preview:typeof s=="function"?s(f,y):{src:f},onClick:t=>{var e;(e=a.onClick)==null||e.call(a,t),v()}})}export{A as default};
