const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./UploadModal-BuHidOho.js","./index-CeJvQM_1.js","./index-9SBFHPtm.css","./index-BOlg8Hu1.js","./PurePanel-Bz4VSSOY.js","./MyApp-gHx8y6RU.js","./useBreakpoint-Dbe9Z3wZ.js","./responsiveObserver-BSAfloFQ.js","./EyeOutlined-twgbw0ak.js","./index-DGLdIViO.js"])))=>i.map(i=>d[i]);
import{az as Ie,bg as Ge,b0 as ze,aG as Xe,aw as ee,ax as ne,r as T,bh as Ve,bi as Ce,aI as i,aK as _,aR as Je,bj as Ze,b4 as Ne,bf as te,aA as G,aF as Ee}from"./index-CeJvQM_1.js";import{d as z}from"./dayjs.min-DIP4bfgQ.js";import en from"./MyTable-U_qLEBP7.js";import{E as nn}from"./ExportButton-BaGvl66e.js";import{v as P,w as A,g as I,d as Ae,b as tn,c as ie,x as sn,t as N,S as K,a as X,T as $,B as De,e as V,y as rn,z as on}from"./MyApp-gHx8y6RU.js";import{u as an}from"./useForceStop-DuL5cB6M.js";import{d as cn}from"./messages-WyWeB4_X.js";import{A as ln}from"./index-Df7Yaov-.js";import{I as dn}from"./index-wZc3PAP3.js";import{R as un}from"./row-CqwnU2ml.js";import{T as hn}from"./index-DGLdIViO.js";import{P as Ue}from"./index-yuZqtdD6.js";import{P as J}from"./index-b0zG9C7a.js";import"./index-BKgApen7.js";import"./Table-Bm4NE9S0.js";import"./addEventListener-CZQz616j.js";import"./index-DmFiukgC.js";import"./PurePanel-Bz4VSSOY.js";import"./SearchOutlined-DgXilZwW.js";import"./index-CRycMmR0.js";import"./index-yTqhQKuY.js";import"./Dropdown-c1od-7ny.js";import"./useBreakpoint-Dbe9Z3wZ.js";import"./responsiveObserver-BSAfloFQ.js";import"./Pagination-CujUnd4X.js";import"./index-DTe5rRoM.js";import"./EyeOutlined-twgbw0ak.js";import"./file-download-Cl0Yz8eU.js";async function gn({myUid:a,targetUid:m=""}){const b=await P({doc_id:"4936483286421335",variables:{id:m||a,query:"",scale:1}});try{const t=A(b||"{}"),{edges:v=[]}=Ie(t,!1);return v.map(h=>{var y,C,f,j,F,R;return{uid:(y=h.node)==null?void 0:y.id,url:((C=h.node)==null?void 0:C.url)||I((f=h.node)==null?void 0:f.id),name:(j=h.node)==null?void 0:j.name,avatar:(R=(F=h.node)==null?void 0:F.photo)==null?void 0:R.uri,avatarLarge:Ae(h.node.id)}})}catch{return[]}}async function mn({myUid:a,targetUid:m}){var v;const b=await P({doc_id:"8752443744796374",variables:{input:{source:"friending_jewel",unfriended_user_id:m,actor_id:a},scale:1}}),t=A(b||"{}");if((v=t.errors)!=null&&v.length)throw new Error(t.errors[0].message);return t}async function fn({myUid:a,targetUid:m}){var v;const b=await P({doc_id:"6294978773852692",variables:{input:{attribution_id_v2:"FriendingCometRoot.react,comet.friending,tap_tabbar,1667288605315,127814,2356318349,",friend_requestee_ids:[m],people_you_may_know_location:"friends_center",refs:[null],source:"people_you_may_know",warn_ack_for_ids:[],actor_id:a},scale:2}}),t=A(b);if((v=t.errors)!=null&&v.length)throw new Error(t.errors[0].message);return t}async function pn({myUid:a,targetUid:m}){var v,h,y,C,f,j,F;const b=await P({doc_id:"5028133957233114",variables:{input:{actor_id:a,user_id:m}}}),t=A(b||"{}");if((v=t.errors)!=null&&v.length)throw new Error(t.errors[0].message);if(((C=(y=(h=t==null?void 0:t.data)==null?void 0:h.user_poke)==null?void 0:y.user)==null?void 0:C.poke_status)!="PENDING")throw new Error("Failed to poke friend: "+((F=(j=(f=t==null?void 0:t.data)==null?void 0:f.user_poke)==null?void 0:j.user)==null?void 0:F.poke_status));return t}async function kn({myUid:a,cursor:m=null}){let b=await P({doc_id:"4186250744800382",variables:{count:8,cursor:m,scale:2,id:btoa(`app_collection:${a}:2356318349:2`)}});return A(b)}async function xn(a){var t,v,h;const m=await P({fb_api_req_friendly_name:"CometContactPresenceUtils_ContactProfilesQuery",variables:{ids:a,scale:2,navigation_fix_gk:!1},doc_id:"8907654129270550"}),b=A(m);return(h=(v=(t=b==null?void 0:b.data)==null?void 0:t.viewer)==null?void 0:v.chat_sidebar_contact_nodes)==null?void 0:h.map(y=>{var C;return{uid:y.id,name:y.name,avatar:(C=y.profile_picture)==null?void 0:C.uri}})}async function vn(){var j,F,R,B,W,U,M,O;const a=await P({fb_api_req_friendly_name:"CometHomeContactsContainerQuery",variables:{numContactsToFetch:17,scale:2,__relay_internal__pv__CometHomeContactListItemsContactListAnRankingIsEnabledrelayprovider:!0},doc_id:"8845828445504279"}),[m,b]=((j=a==null?void 0:a.split)==null?void 0:j.call(a,`
`))||[],t=A(m),v=[];for(let E of Ge(t,"chat_sidebar_contacts")||[])v.push({uid:E.id,name:E.name,avatar:(F=E.profile_picture)==null?void 0:F.uri});const h=A(b),C=(((O=(M=(U=(W=(B=(R=h==null?void 0:h.data)==null?void 0:R.mnet_ranks)==null?void 0:B.edges)==null?void 0:W[0])==null?void 0:U.node)==null?void 0:M.items)==null?void 0:O.edges)||[]).map(E=>{var D;return(D=E.node)==null?void 0:D.user_id}).filter(Boolean),f=await xn(C);if(f.length>0){const E=new Set(v.map(D=>D.uid));for(let D of f)E.has(D.uid)||(E.add(D.uid),v.push(D))}return v}const bn=T.lazy(()=>Je(()=>import("./UploadModal-BuHidOho.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9]),import.meta.url)),{Title:yn}=hn,k={FRIEND:"Friend",POKED:"Poked",UNFRIENDED:"Unfriended",REQUESTED:"Requested friend",NEW:"New friend"},Fn={[k.POKED]:"green",[k.UNFRIENDED]:"red",[k.NEW]:"blue",[k.REQUESTED]:"pink"},$e=a=>{switch(a){case k.FRIEND:return{en:"Friend",vi:"Bạn bè"};case k.POKED:return{en:"Poked",vi:"Đã chọc"};case k.UNFRIENDED:return{en:"Unfriended",vi:"Đã huỷ kết bạn"};case k.REQUESTED:return{en:"Requested friend",vi:"Đã gửi kết bạn"};case k.NEW:return{en:"New friend",vi:"Chưa kết bạn"};default:return a}},jn=a=>{const m=(a==null?void 0:a.statuses)||[];return!m.includes(k.REQUESTED)&&(m.includes(k.NEW)||m.includes(k.UNFRIENDED))},wn=a=>{const m=(a==null?void 0:a.statuses)||[];return!m.includes(k.NEW)&&!m.includes(k.UNFRIENDED)},se={"Name contains special characters":{en:"Special characters",vi:"Ký tự đặc biệt",color:"orange"},"Name contains numbers":{en:"Contains numbers",vi:"Chứa số",color:"purple"},"No avatar":{en:"No avatar",vi:"Không avatar",color:"cyan"},"Strange uid":{en:"Strange UID",vi:"UID lạ",color:"blue"},Locked:{en:"Locked",vi:"Bị khoá",color:"red"},"Blocked messages":{en:"Blocked messages",vi:"Chặn tin nhắn",color:"red"}},Te={MALE:{en:"Male",vi:"Nam"},FEMALE:{en:"Female",vi:"Nữ"},UNKNOWN:{en:"Unknown",vi:"Không xác định"}};function Zn(){const{message:a,notification:m}=tn(),b=ze(),{ti:t}=Xe(),v=an(),h=ee(ne.profile),y=ee(ne.friendsByUid),C=ee(ne.setFriendsByUid),[f,j]=ie("AllFriends.data",[]),[F,R]=ie("AllFriends.interactions",[]),[B,W]=ie("AllFriends.ranking",[]),U=T.useMemo(()=>{var s,o;const e=new Map,n=new Map;for(let c of F)(s=c.reactions_uid)==null||s.forEach(u=>e.set(u,(e.get(u)||0)+1)),(o=c.comments_uid)==null||o.forEach(u=>n.set(u,(n.get(u)||0)+1));return{reactions:e,comments:n}},[F]),M=T.useMemo(()=>(f==null?void 0:f.map((e,n)=>{var s,o,c;return{...e,recent:n,comments:((s=U==null?void 0:U.comments)==null?void 0:s.get(e.uid))||0,reactions:((o=U==null?void 0:U.reactions)==null?void 0:o.get(e.uid))||0,ranking:B==null?void 0:B.indexOf(e.uid),quickFilters:[(c=e.uid)!=null&&c.startsWith("1000")?null:"Strange uid",sn(e.avatar)?"No avatar":null,/\d/.test(e.name)?"Name contains numbers":null,Ve(e.name)?"Name contains special characters":null].filter(Boolean)}}))||[],[f,U,B]),[O,E]=T.useState(!1),[D,re]=T.useState(0),[Re,oe]=T.useState(!1),[ae,ce]=T.useState(!1),Q=T.useRef(null);T.useEffect(()=>{h!=null&&h.uid&&!(f!=null&&f.length)&&le()},[]);const Y=(e,n,s=!1,o=!1)=>{j(c=>te(c,g=>{Array.isArray(e)||(e=[e]);let p=[];for(let r of e){let l=g.findIndex(x=>x.uid==((r==null?void 0:r.uid)||r)),d=g[l];d?(d.statuses||(d.statuses=[]),!s&&!d.statuses.includes(n)?d.statuses.push(n):(Array.isArray(n)||(n=[n]),d.statuses=n),o&&p.push({index:l,data:d})):o?g.unshift({...r,statuses:[n]}):g.push({...r,statuses:[n]})}for(let{index:r,data:l}of p)g.splice(r,1),g.unshift(l);return g}))},Be=(e=f)=>{let n=!1;const s=(y==null?void 0:y[h.uid])||[],o=e.map(l=>l.uid),c=s.map(l=>l.uid),u=new Set(o),g=new Set(c),p=o.filter(l=>!g.has(l)),r=c.filter(l=>!u.has(l));p.length&&(n=!0,console.log("New friends: ",p),Y(p,k.NEW,!0),s!=null&&s.length?m.open({type:"success",duration:0,message:t({en:`Find ${p.length} new friends`,vi:`Tìm thấy ${p.length} bạn mới`}),description:i.jsx("div",{style:{maxHeight:300,overflowY:"auto",overflowX:"hidden"},children:i.jsx("ol",{children:p.map(l=>{const d=e.find(x=>x.uid==l);return i.jsx("li",{children:i.jsx("a",{href:I(l),target:"_blank",children:(d==null?void 0:d.name)||l})},l)})})})}):m.open({type:"success",duration:0,message:t({en:`Saved friends to cache: ${p.length}`,vi:`Đã lưu danh sách bạn bè: ${p.length}`}),description:t({en:"Will notify if you have new friends / someone unfriended to you in future",vi:"Sẽ thông báo nếu có bạn mới / người huỷ kết bạn với bạn trong tương lai"})})),r.length&&(n=!0,console.log("Deleted friends: ",r),m.open({type:"info",duration:0,message:t({en:`Find ${r.length} unfriended`,vi:`Có ${r.length} người huỷ kết bạn`}),description:i.jsx("div",{style:{maxHeight:300,overflowY:"auto",overflowX:"hidden"},children:i.jsx("ol",{children:r.map(l=>{const d=s.find(x=>x.uid==l);return i.jsx("li",{children:i.jsx("a",{href:I(l),target:"_blank",children:(d==null?void 0:d.name)||l})},l)})})})})),n&&C(h==null?void 0:h.uid,e.map(l=>({uid:l.uid,name:l.name})))},le=()=>{if(O)return;N("AllFriends:onClickReload");const e="onClickReload";a.loading({key:e,content:t({en:"Fetching friends...",vi:"Đang tải bạn bè..."}),duration:0}),E(!0),gn({myUid:h==null?void 0:h.uid}).then(n=>{var s;if(Be(n),!(n!=null&&n.length))return a.error({key:e,content:t({en:"No data to show",vi:"Không có dữ liệu"})});j(n),console.log(n),a.success({key:e,content:t({en:"Fetch friends completed",vi:"Tải xong bạn bè"})}),(s=Q.current)==null||s.clearFilter()}).catch(n=>{a.error({key:e,content:t({en:"Failed to fetch friends",vi:"Lỗi tải bạn bè"})+": "+n.message}),console.log(n)}).finally(()=>{E(!1)})},de=async e=>{N("AllFriends:onClickUnfriendOne");const n="onClickUnfriendOne"+e.uid;try{return a.loading({key:n,content:t({en:"Unfriending...",vi:"Đang huỷ kết bạn..."})+" "+e.name,duration:0}),await mn({myUid:h==null?void 0:h.uid,targetUid:e.uid}),a.success({key:n,content:t({en:"Unfriend completed",vi:"Đã huỷ kết bạn"})+": "+e.name}),Y(e,k.UNFRIENDED),!0}catch(s){return a.error({key:n,content:t({en:"Failed to unfriend",vi:"Lỗi huỷ kết bạn"})+": "+e.name+": "+s.message}),console.log(s),!1}},Se=async e=>{if(!await V())return;N("AllFriends:onClickUnfriendSelected");const n=new Set;for(let o of e)await de(o)&&n.add(o.uid),await G(500);const s=n.size+"/"+e.length;m.open({type:"success",message:t({en:"Success",vi:"Thành công"}),description:t({en:`Unfriended completed ${s} friends`,vi:`Đã huỷ kết bạn với ${s} người`}),duration:0})},ue=async e=>{N("AllFriends:onClickPokeFriend");const n="onClickPokeFriend"+e.uid;try{return a.loading({key:n,content:t({en:"Poking...",vi:"Đang chọc..."})+" "+e.name,duration:0}),await pn({myUid:h==null?void 0:h.uid,targetUid:e.uid}),a.success({key:n,content:t({en:"Poke completed",vi:"Chọc thành công"})+": "+e.name}),Y(e,k.POKED),!0}catch(s){return a.error({key:n,content:t({en:"Failed to poke",vi:"Chọc thất bại"})+": "+e.name+": "+s.message}),console.log(s),!1}},qe=async e=>{N("AllFriends:onClickPokeSelected");const n=new Set;for(let o of e)await ue(o)&&n.add(o.uid),await G(500);const s=n.size+"/"+e.length;m.open({type:"success",message:t({en:"Success",vi:"Thành công"}),description:t({en:`Poke completed ${s} friends`,vi:`Đã chọc ${s} bạn`}),duration:0})},he=async e=>{N("AllFriends:onClickAddFriend");const n="onClickAddFriend"+e.uid;try{return a.loading({key:n,content:t({en:"Sending friend request...",vi:"Đang gửi kết bạn..."})+" "+e.name,duration:0}),await fn({myUid:h==null?void 0:h.uid,targetUid:e.uid}),a.success({key:n,content:t({en:"Send friend request success",vi:"Gửi kết bạn thành công"})+": "+e.name}),Y(e,k.REQUESTED),!0}catch(s){return a.error({key:n,content:t({en:"Failed to send friend request",vi:"Lỗi gửi kết bạn"})+": "+s.message}),!1}},Le=async e=>{if(!await V())return;N("AllFriends:onClickAddFriendSelected");const n=new Set;for(let o of e)await he(o)&&n.add(o.uid),await G(500);const s=n.size+"/"+e.length;m.open({type:"success",message:t({en:"Success",vi:"Thành công"}),description:t({en:`Sent friend request success ${s} users`,vi:`Gửi kết bạn thành công với ${s} người`}),duration:0})},Me=async()=>{var g,p;if(D)return;const e="AllFriends:onClickFindBlockedMessages";N(e);const n=(g=Q.current)==null?void 0:g.getDataSelected(),s=n!=null&&n.length?n:f,o=[];let c=!1;for(let r=0;r<s.length&&!c;r++){re(!0),a.loading({key:e,duration:0,content:i.jsxs(i.Fragment,{children:[t({en:"Finding blocked messages...",vi:"Đang tìm bạn bè chặn tin nhắn..."})+`${o.length}/${r+1} - ${~~(r/s.length*100)}%`,i.jsx("br",{}),i.jsx("i",{children:t({en:"Click to stop",vi:"Bấm để dừng"})})]}),onClick:()=>c=!0});const l=s[r];await cn(l.uid)||(o.push(l),(p=Q.current)==null||p.setDataSelected(o.map(d=>f.find(x=>x.uid===d.uid)||d)),j(d=>te(d,x=>{var S;const w=x.find(q=>q.uid===l.uid);w&&!((S=w.quickFilters)!=null&&S.includes("Blocked messages"))&&(w.quickFilters||(w.quickFilters=[]),w.quickFilters.push("Blocked messages"))})),a.success({key:e,content:t({en:"Found",vi:"Tìm thấy"})+" "+l.name+" ("+o.length+")"}))}re(!1);const u=o.length?i.jsxs(i.Fragment,{children:[t({en:`Found ${o.length} friends blocking your messages`,vi:`Tìm thấy ${o.length} bạn bè chặn tin nhắn`}),i.jsx("br",{}),i.jsx("ul",{children:o.map(r=>i.jsx("li",{children:r.name},r.uid))})]}):t({en:"No one block messages you",vi:"Không ai chặn tin nhắn của bạn"});a.success({key:e,content:u}),m.open({type:"success",message:t({en:"Success",vi:"Thành công"}),description:u,duration:0})},Ye=async e=>{var n;if(!e)return a.error(t({en:"File empty",vi:"File rỗng"}));N("AllFriends:onUploadFriendsFile");try{const s=A(e,[]);if(!Array.isArray(s)||!(s!=null&&s.length))return a.error(t({en:"No data",vi:"Không có dữ liệu"}));const o=s.map(r=>r.uid).filter(Boolean);debugger;if(!o.length)return a.error(t({en:"No friends data in file",vi:"Không có dữ liệu bạn bè trong file"}));const c=new Set(o),u=[];for(let r of f)c.has(r.uid)||u.push(r);const g=new Set(f.map(r=>r.uid)),p=[];for(let r of s)g.has(r.uid)||p.push(r);Y(u,k.NEW,!1,!0),Y(p,k.UNFRIENDED,!1,!0),[{title:t({en:`Found ${u.length} new friends`,vi:`Tìm thấy ${u.length} bạn mới`}),text:i.jsx("div",{style:{maxHeight:300,overflowY:"auto",overflowX:"hidden"},children:i.jsx("ol",{children:u.map(r=>i.jsx("li",{children:i.jsx("a",{href:I(r.uid),target:"_blank",children:r.name})},r.uid))})})},{title:t({en:`Found ${p.length} unfriended`,vi:`Tìm thấy ${p.length} người huỷ kết bạn`}),text:i.jsx("div",{style:{maxHeight:300,overflowY:"auto",overflowX:"hidden"},children:i.jsx("ol",{children:p.map(r=>i.jsx("li",{children:i.jsx("a",{href:I(r.uid),target:"_blank",children:r.name})},r.uid))})})}].forEach(({title:r,text:l})=>m.open({type:"success",message:r,description:l,duration:0})),(p.length||u.length)&&((n=Q.current)==null||n.setDataSelected([...p,...u]))}catch(s){a.error(s.message)}},Pe=e=>{b("/bulk-downloader",{state:{targetId:e,platform:Ze.Facebook}})},He=async()=>{if(!await V()||ae)return;ce(!0);const e=v.start(),n="AllFriends:onClickScanInteractions";N(n),a.loading({key:n,duration:0,content:t({en:"Loading posts...",vi:"Đang tải bài viết..."})});let s=!1;const o=await rn(1/0,r=>{var S;R([...r]);const l=r.reduce((q,H)=>{var L;return q+(((L=H.comments_uid)==null?void 0:L.length)||0)},0),d=r.reduce((q,H)=>{var L;return q+(((L=H.reactions_uid)==null?void 0:L.length)||0)},0),x=new Date(((S=r[r.length-1])==null?void 0:S.created_time)||0),w=Ee(x);a.loading({key:n,duration:0,content:i.jsxs(i.Fragment,{children:[t({en:`Loading ${w}: ${r.length} posts, ${d} reactions, ${l} comments...`,vi:`Đang tải ${w}: ${r.length} bài viết, ${d} lượt thích, ${l} bình luận...`}),i.jsx("br",{}),i.jsx("i",{children:t({en:"Click to stop",vi:"Bấm để dừng"})})]}),onClick:()=>s=!0})},()=>s||e.value()),c=o.reduce((r,l)=>{var d;return r+(((d=l.comments_uid)==null?void 0:d.length)||0)},0),u=o.reduce((r,l)=>{var d;return r+(((d=l.reactions_uid)==null?void 0:d.length)||0)},0);a.destroy(n);const g=o[o.length-1],p=Ee(new Date((g==null?void 0:g.created_time)||0));m.open({type:"success",duration:0,message:t({en:"Scan interactions finished",vi:"Quét tương tác xong"}),description:i.jsxs(i.Fragment,{children:[t({en:`Scanned ${o.length} posts, ${u} reactions, ${c} comments, last post ${p} `,vi:`Quét được ${o.length} bài viết, ${u} lượt thích, ${c} bình luận, bài viết cuối ${p} `}),i.jsx("a",{href:I(g==null?void 0:g.postId),target:"_blank",children:I(g==null?void 0:g.postId)})]})}),R(o),ce(!1)},Oe=async()=>{const e="AllFriends:onClickFindBuddy";N(e),a.loading({key:e,duration:0,content:t({en:"Scanning ranking friends...",vi:"Đang tải xếp hạng bạn bè..."})});const n=await vn();console.log(n),a.destroy(e),m.open({type:"success",duration:0,message:t({en:`Scan ranking completed: ${n.length} friends`,vi:`Quét xếp hạng bạn bè xong: ${n.length} bạn`}),description:i.jsxs(i.Fragment,{children:["Top 20:",i.jsx("br",{}),i.jsx("ol",{children:n.slice(0,20).map((c,u)=>i.jsxs(i.Fragment,{children:[i.jsx("a",{href:I(c.uid),target:"_blank",children:u+1+": "+c.name},c.uid),i.jsx("br",{})]}))})]})}),W(n.map(c=>c.uid));const s=new Set(f.map(c=>c.uid)),o=n.filter(c=>!s.has(c.uid));o.length&&Y(o,k.NEW,!0)},Qe=async()=>{if(!await V())return;oe(!0);const e="AllFriends:onClickDeepScan";N(e),a.loading({key:e,content:t({en:"Deep Scanning...",vi:"Đang quét chuyên sâu..."}),duration:0});const n=await on(),s=[];let o=null;for(;;){const c=await kn({myUid:n,cursor:o}),{edges:u=[],page_info:g={}}=Ie(c)||{};if(!u.length)break;const p=u.map(r=>{var d,x,w,S,q,H,L,ge,me,fe,pe,ke,xe,ve,be,ye,Fe,je,we,_e;let l=(x=(d=r==null?void 0:r.node)==null?void 0:d.node)==null?void 0:x.id;if(!/^\d+$/.exec(l))try{let Z=atob(l);l=((w=/\d+/.exec(Z))==null?void 0:w[0])||l}catch(Z){console.log(Z)}return{uid:l,name:(q=(S=r==null?void 0:r.node)==null?void 0:S.title)==null?void 0:q.text,avatar:(L=(H=r==null?void 0:r.node)==null?void 0:H.image)==null?void 0:L.uri,avatarLarge:Ae(l),url:(ge=r==null?void 0:r.node)==null?void 0:ge.url,mutualFriendCount:((ke=(pe=(fe=(me=r==null?void 0:r.node)==null?void 0:me.subtitle_text)==null?void 0:fe.aggregated_ranges)==null?void 0:pe[0])==null?void 0:ke.count)||0,gender:((je=(Fe=(ye=(be=(ve=(xe=r==null?void 0:r.node)==null?void 0:xe.actions_renderer)==null?void 0:ve.action)==null?void 0:be.client_handler)==null?void 0:ye.profile_action)==null?void 0:Fe.restrictable_profile_owner)==null?void 0:je.gender)||"UNKNOWN",isLocked:!((we=r==null?void 0:r.node)!=null&&we.subtitle_text)||!((_e=r==null?void 0:r.node)!=null&&_e.url),cursor:(r==null?void 0:r.cursor)||(g==null?void 0:g.end_cursor)}});j(r=>te(r,l=>(p.forEach(d=>{if(!d.uid)return;const x=l.find(w=>w.uid===d.uid);x?(x.mutualFriendCount=d.mutualFriendCount,x.gender=d.gender,x.quickFilters||(x.quickFilters=[]),d.isLocked&&!x.quickFilters.includes("Locked")&&x.quickFilters.push("Locked")):d.isLocked&&l.push({...d,quickFilters:["Locked"]})}),l))),s.push(...p),o=p[p.length-1].cursor,a.loading({key:e,content:t({en:"Deep Scanning...",vi:"Đang quét chuyên sâu..."})+`${~~(s.length/f.length*100)}% (${s.length}/${f.length})`,duration:0}),await G(200)}a.destroy(e),m.open({type:"success",message:t({en:"Deep Scanning completed",vi:"Hoàn tất Quét chuyên sâu"})+` (${s.length}/${f.length})`,description:t({en:'Please see in "Quick filters" column',vi:'Vui lòng xem cột "Bộ lọc"'})}),oe(!1)},Ke=[{title:"#",key:"recent",dataIndex:"recent",sorter:(e,n)=>e.recent-n.recent,render:(e,n,s)=>n.recent+1,width:70,align:"center"},{title:t({en:"Name",vi:"Tên"}),dataIndex:"name",key:"name",sorter:(e,n)=>e.name.localeCompare(n.name),onSearch:(e,n,s)=>Ce(e,n)||Ce(e,s==null?void 0:s.uid),render:(e,n,s)=>i.jsxs(K,{style:{maxWidth:300},children:[i.jsx(ln,{shape:"square",src:i.jsx(dn,{src:n.avatarLarge,fallback:n.avatar}),size:50}),i.jsxs(K,{direction:"vertical",style:{marginLeft:"10px"},size:0,children:[i.jsx("a",{href:n.url||I(n.uid),target:"_blank",children:i.jsx("b",{children:n.name})}),i.jsx("span",{style:{opacity:.5},children:n.uid})]})]}),width:"auto"},{title:t({en:"Quick Filters",vi:"Bộ lọc"}),dataIndex:"quickFilters",key:"quickFilters",render:(e,n,s)=>{var o;return((o=n.quickFilters)==null?void 0:o.map(c=>i.jsx(X,{color:se[c].color,children:t(se[c])},c)))||""},filters:Object.entries(se).map(([e,n])=>({text:t(n)+" ("+f.filter(s=>{var o;return(o=s.quickFilters)==null?void 0:o.includes(e)}).length+")",value:e})),onFilter:(e,n)=>{var s;return(s=n.quickFilters)==null?void 0:s.includes(e)},width:150},...f.find(e=>e.gender)?[{title:t({en:"Gender",vi:"Giới tính"}),key:"gender",dataIndex:"gender",render:(e,n,s)=>{const o=t(Te[n.gender])||"-";return n.gender==="FEMALE"?i.jsx(X,{color:"pink",children:o}):o},filters:Object.entries(Te).map(([e,n])=>({text:t(n)+" ("+f.filter(s=>s.gender===e).length+")",value:e})),onFilter:(e,n)=>n.gender==e,width:120}]:[],...f.find(e=>e.mutualFriendCount)?[{title:t({en:"Mutual",vi:"Bạn chung"}),key:"mutualFriendCount",dataIndex:"mutualFriendCount",sorter:(e,n)=>e.mutualFriendCount-n.mutualFriendCount,width:120,align:"right"}]:[],...B.length?[{title:t({en:"Ranking",vi:"Xếp hạng"}),key:"ranking",dataIndex:"ranking",render:(e,n,s)=>e==-1?"_":e+1,sorter:(e,n)=>(e.ranking==-1?1/0:e.ranking)-(n.ranking==-1?1/0:n.ranking),width:100,align:"right"}]:[],...F!=null&&F.length?[{title:t({en:"Reactions",vi:"Thích"}),key:"reactions",dataIndex:"reactions",sorter:(e,n)=>e.reactions-n.reactions,width:100,align:"right"},{title:t({en:"Comments",vi:"Bình luận"}),key:"comments",dataIndex:"comments",sorter:(e,n)=>e.comments-n.comments,width:100,align:"right"}]:[],{title:t({en:"Friend status",vi:"Trạng thái"}),dataIndex:"status",key:"status",width:150,filters:Object.entries(k).map(([e,n])=>({text:t($e(n))+" ("+f.filter(s=>{var o,c;return((o=s.statuses)==null?void 0:o.includes(n))||n===k.FRIEND&&!((c=s.statuses)!=null&&c.length)}).length+")",value:n})),onFilter:(e,n)=>{var s,o;return((s=n.statuses)==null?void 0:s.includes(e))||e==k.FRIEND&&!((o=n.statuses)!=null&&o.length)},render:(e,n,s)=>{var o;return(o=n==null?void 0:n.statuses)!=null&&o.length?n.statuses.map(c=>({key:c,value:t($e(c))})).map(({key:c,value:u})=>i.jsx(X,{color:Fn[c],children:u},c)):t({en:"Friend",vi:"Bạn bè"})},align:"right"},{title:t({en:"Action",vi:"Hành động"}),dataIndex:"action",key:"download",render:(e,n,s)=>{var o,c;return i.jsxs(K.Compact,{children:[i.jsx($,{title:t({en:"Bulk Downloader",vi:"Tải hàng loạt"}),children:i.jsx(_,{type:"default",onClick:()=>Pe(n.uid),icon:i.jsx("i",{className:"fa-solid fa-download"})})}),i.jsx($,{title:t({en:"Poke",vi:"Chọc"}),children:i.jsx(_,{type:"default",onClick:()=>ue(n),icon:i.jsx("i",{className:"fa-regular fa-hand-point-right"})})}),(o=n.statuses)!=null&&o.includes(k.UNFRIENDED)||(c=n.statuses)!=null&&c.includes(k.NEW)?i.jsx($,{title:t({en:"Request friend",vi:"Gửi kết bạn"}),children:i.jsx(_,{type:"default",onClick:()=>he(n),icon:i.jsx("i",{className:"fa-solid fa-user-plus"})})}):i.jsx($,{title:t({en:"Unfriend",vi:"Huỷ kết bạn"}),children:i.jsx(_,{danger:!0,onClick:()=>de(n),icon:i.jsx("i",{className:"fa-solid fa-trash-can"})})})]})},width:150,align:"right"}],We=e=>{var o,c;const n=(o=e==null?void 0:e.filter)==null?void 0:o.call(e,jn),s=(c=e==null?void 0:e.filter)==null?void 0:c.call(e,wn);return i.jsxs(i.Fragment,{children:[i.jsx(_,{type:"primary",icon:O?i.jsx("i",{className:"fa-solid fa-rotate-right fa-spin"}):i.jsx("i",{className:"fa-solid fa-rotate-right"}),onClick:le,children:t({en:"Reload",vi:"Tải lại"})}),i.jsx(nn,{data:e.length?e:f,options:[{key:"uid",label:".txt (friend uid)",prepareData:u=>({fileName:"friends_"+z().format("YYYY-MM-DD-HHmmss")+".txt",data:u.map(g=>g.uid).join(`
`)})},{key:"uid_name",label:".csv (friend uid+name)",prepareData:u=>({fileName:"friends_uid_name_"+z().format("YYYY-MM-DD-HHmmss")+".csv",data:Ne(u.map(g=>({uid:g.uid,name:g.name})))})},{key:"json",label:".json",prepareData:u=>({fileName:"friends"+z().format("YYYY-MM-DD-HHmmss")+".json",data:JSON.stringify(u,null,4)})},{key:"csv",label:".csv",prepareData:u=>({fileName:"friends"+z().format("YYYY-MM-DD-HHmmss")+".csv",data:Ne(u)})}]}),i.jsxs(K.Compact,{children:[i.jsx(Ue,{title:t({en:"Check who is blocking your messages",vi:"Xem ai đang chặn tin nhắn của bạn"}),content:i.jsxs("ul",{children:[i.jsx("li",{children:t({en:"You still can message them",vi:"Bạn vẫn nhắn được cho họ"})}),i.jsx("li",{children:t({en:"They can still read your messages",vi:"Họ vẫn đọc được tin nhắn"})}),i.jsx("li",{children:t({en:"But facebook will never mark as read",vi:"Nhưng facebook sẽ không cập nhật trạng thái đã xem"})})]}),children:i.jsx(J,{title:t(t({en:"Check who is blocking your messages",vi:"Xem ai đang chặn tin nhắn của bạn"})),description:i.jsxs("ul",{children:[i.jsx("li",{children:t({en:`Are you sure to check ${(e==null?void 0:e.length)||M.length} friends?.
 `,vi:`Bạn có chắc muốn kiểm tra ${(e==null?void 0:e.length)||M.length} bạn bè?.`})}),i.jsx("li",{children:t({en:"You can select friends to check, instead of check all, to reduce load time.",vi:"Bạn có thể chọn bạn bè để kiểm tra, thay vì kiểm tra tất cả, để giảm thời gian xử lý."})})]}),onConfirm:Me,okText:t({en:"Yes",vi:"Kiểm tra"}),cancelText:t({en:"No",vi:"Huỷ"}),children:i.jsx(_,{loading:!!D,icon:i.jsx("i",{className:"fa-solid fa-comment-slash"})})})}),i.jsx(bn,{accept:".json",title:t({en:"Upload friends file",vi:"Tải lên file bạn bè đã lưu"}),text:t({en:"Click or drag file to this area to upload",vi:"Click chọn hoặc kéo thả file vào đây"}),hint:t({en:"Support only .json backup file",vi:"Chỉ hỗ trợ file .json được xuất từ trang này"}),onSubmit:Ye,renderButton:({showModal:u})=>i.jsx(Ue,{title:t({en:"Check who unfriend you",vi:"Kiểm tra ai huỷ kết bạn với bạn"}),content:i.jsxs("ul",{children:[i.jsx("li",{children:t({en:"How it work: Export friends data to file, then compare it later",vi:"Cách hoạt động: Lưu danh sách bạn bè ra file trước, sau đó so sánh"})}),i.jsx("li",{children:t({en:"FB AIO can automatically detect who unfriend you",vi:"FB AIO sẽ tự động thông báo khi có người huỷ kết bạn"})}),i.jsx("li",{children:t({en:"Only use this feature if you want manual check",vi:"Chỉ sử dụng chức năng này nếu bạn muốn chủ động kiểm tra bằng tay"})})]}),children:i.jsx(_,{onClick:u,icon:i.jsx("i",{className:"fa-solid fa-user-slash"})})})}),i.jsx($,{title:t({en:"Rank who has interacted with you the most recently. (Recent interactions)",vi:"Xếp hạng xem ai tương tác với bạn nhiều nhất thời gian gần đây (Tương tác gần đây)"}),children:i.jsx(_,{onClick:Oe,icon:i.jsx("i",{className:"fa-solid fa-ranking-star"}),children:t({en:"Ranking",vi:"Xếp hạng"})})}),i.jsx($,{title:t({en:"Count friend's reactions and comments on all of your profile's posts (Total interactions)",vi:"Đếm like và comment của bạn bè trên tất cả bài viết của bạn (Tổng tương tác)"}),children:i.jsx(De,{count:"Hot",color:"red",style:{color:"white",zIndex:3},children:i.jsx(_,{loading:ae,icon:i.jsx("i",{className:"fa-solid fa-thumbs-up"}),onClick:He,children:t({en:"Interactions",vi:"Tương tác"})})})}),i.jsx($,{title:t({en:"Deep scan all friends to get: locked friends, gender, mutual friends ...",vi:"Quét tất cả bạn bè để biết: bạn bè bị khoá, giới tính, bạn chung ..."}),children:i.jsx(De,{count:t({en:"New",vi:"Mới"}),color:"purple",style:{color:"white",zIndex:3},children:i.jsx(_,{loading:!!Re,onClick:Qe,icon:i.jsx("i",{className:"fa-solid fa-magnifying-glass"}),children:t({en:"Deep scan",vi:"Quét chuyên sâu"})})})})]}),i.jsx(K.Compact,{children:e!=null&&e.length?i.jsxs(i.Fragment,{children:[i.jsx($,{title:t({en:`Poke ${e.length} selected friends`,vi:`Chọc ${e.length} người được chọn`}),children:i.jsx(J,{title:t({en:`Poke ${e.length} selected friends`,vi:`Chọc ${e.length} người được chọn`}),description:t({en:"Are you sure to poke these friends?",vi:"Bạn có chắc muốn chọc những người này?"}),onConfirm:()=>qe(e),okText:t({en:"Yes",vi:"Chọc mạnh vào"}),cancelText:t({en:"No",vi:"Tha"}),children:i.jsx(_,{type:"default",icon:i.jsx("i",{className:"fa-solid fa-hand-point-right"}),children:e.length?" "+e.length:""})})}),(n==null?void 0:n.length)>0?i.jsx($,{title:t({en:`Request friend with ${n.length} selected users`,vi:`Gửi kết bạn với ${n.length} người được chọn`}),children:i.jsx(J,{title:t({en:`Request friend with ${n.length} selected users`,vi:`Gửi kết bạn với ${n.length} người được chọn`}),description:t({en:"Are you sure to send friend request to these users?",vi:"Bạn có chắc muốn gửi lời mời kết bạn cho những người này?"}),onConfirm:()=>Le(n),okText:t({en:"Yes",vi:"Gửi"}),cancelText:t({en:"No",vi:"Huỷ"}),children:i.jsx(_,{icon:i.jsx("i",{className:"fa-solid fa-user-plus"}),children:n.length})})}):null,(s==null?void 0:s.length)>0?i.jsx($,{title:t({en:`Unfriend ${s.length} selected friends`,vi:`Huỷ kết bạn ${s.length} người được chọn`}),children:i.jsx(J,{title:t({en:`Unfriend ${s.length} selected friends`,vi:`Huỷ kết bạn ${s.length} người được chọn`}),description:t({en:"Are you sure to unfriend these friends?",vi:"Bạn có chắc muốn huỷ kết bạn những người này?"}),onConfirm:()=>Se(s),okText:t({en:"Yes",vi:"Bye bye"}),cancelText:t({en:"No",vi:"Tha"}),children:i.jsx(_,{danger:!0,icon:i.jsx("i",{className:"fa-solid fa-trash-can"}),children:s.length})})}):null]}):null})]})};return i.jsxs("div",{style:{display:"flex",flexDirection:"column",width:"100%",height:"100%"},children:[i.jsxs(un,{align:"middle",style:{margin:"16px"},children:[i.jsx(yn,{level:3,style:{margin:0},children:t({en:"Friends manager",vi:"Quản lý bạn bè"})}),i.jsx(X,{style:{marginLeft:"10px",fontWeight:"bold",color:"#888"},children:M.length})]}),i.jsx(en,{ref:Q,data:M,columns:Ke,size:"small",searchable:!0,selectable:!0,keyExtractor:e=>e.uid,style:{flex:1,maxHeight:"100%"},renderTitle:We})]})}export{Zn as default};
