const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./VideoViewer-DUjJMbeM.js","./index-DydTkMV2.js","./index-9SBFHPtm.css","./videos-CPZXESpQ.js","./MyApp-BeWNgXar.js","./VideoWithMuted-Bb6r0PlC.js","./PostMediaset-4bewsBLP.js","./Collection-C4FEEISw.js","./index-DhNGfTEU.js","./file-download-BRim8Hre.js","./index-DnAZdSG1.js","./Dropdown-BQv78xjs.js","./PurePanel-bZQXf2rU.js","./index-PaDwoYYR.js","./index-Bb9pHj-Y.js","./index-CIyDf2jJ.js","./EyeOutlined-1iI3OztS.js","./SearchOutlined-BzS9TeDb.js","./index-BZoZolhB.js","./Pagination-Tj3qyxsl.js","./useBreakpoint-BQHjIOgG.js","./responsiveObserver-DJIVJZWQ.js","./index-CQW_sFN6.js","./row-8w7dkT51.js","./index-BVD0kgnH.js","./icons-Dm-vLmKJ.js","./index-BFppcxJr.js"])))=>i.map(i=>d[i]);
import{aH as Q,b1 as J,r as D,b8 as O,aJ as t,bl as I,ba as G,b0 as Y,aL as x,b9 as Z,$ as R,aS as A,b6 as j}from"./index-DydTkMV2.js";import{b as ee,c as _,P as k,t as m,S as g,d as te,g as ne,B as ie,C as N,T as h,a as se,D as B,h as oe,e as ae,E as re}from"./MyApp-BeWNgXar.js";import{d as le}from"./dayjs.min-DjwpXSjs.js";import ce from"./MyTable-C4ZvRZ43.js";import{E as de}from"./ExportButton-CViKdVRw.js";import{u as he}from"./useAction-C_TejcXm.js";import{A as me}from"./index-DIvNmdxF.js";import{I as F}from"./index-D7DPDq-n.js";import{C as ge}from"./index-OkMwgQe1.js";import{T as p}from"./index-CIyDf2jJ.js";import{P as ue}from"./index-5v9p6Q2h.js";import{R as xe}from"./row-8w7dkT51.js";import{I as pe}from"./index-Bb9pHj-Y.js";import{D as ye}from"./index-ayc5lMkD.js";import{S as b}from"./index-CQW_sFN6.js";import"./index-DhNGfTEU.js";import"./Table-BJnGvbKm.js";import"./addEventListener-C_bz9vvg.js";import"./index-PaDwoYYR.js";import"./index-DnAZdSG1.js";import"./Dropdown-BQv78xjs.js";import"./PurePanel-bZQXf2rU.js";import"./useBreakpoint-BQHjIOgG.js";import"./responsiveObserver-DJIVJZWQ.js";import"./Pagination-Tj3qyxsl.js";import"./SearchOutlined-BzS9TeDb.js";import"./file-download-BRim8Hre.js";import"./index-BHMCsDY4.js";import"./EyeOutlined-1iI3OztS.js";import"./index-BH04_x8C.js";const ve=R.lazy(()=>A(()=>import("./VideoViewer-DUjJMbeM.js"),__vite__mapDeps([0,1,2,3,4,5]),import.meta.url)),fe=R.lazy(()=>A(()=>import("./PostMediaset-4bewsBLP.js"),__vite__mapDeps([6,1,2,7,8,9,4,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,3,25,5,26]),import.meta.url));function Je(){const{ti:s}=Q(),{message:v}=ee(),E=J();he();const[u,f]=_("MyPosts.postFilters",{uid:"",privacy:k.ALL,omitPinnedPost:!0,beforeTime:null,taggedInOnly:!1,postedByOthers:null}),[y,w]=_("MyPosts.posts",[]),[L,C]=_("MyPosts.loading",!1),M=D.useMemo(()=>y.map((n,e)=>({...n,recent:e})),[y]);D.useEffect(()=>{m("Posts:onLoad")},[]);const U=async()=>{m("Posts:onClickReload"),C(!0);const n=await B(u);n.length?(w(n),console.log(n)):v.info(s({en:"No data found",vi:"KhÃ´ng cÃ³ dá»¯ liá»‡u"})),C(!1)},V=async()=>{var e;m("Posts:onClickLoadMore"),C(!0);const n=await B({...u,cursor:(e=y[y.length-1])==null?void 0:e.cursor});n!=null&&n.length?(w(o=>[...o,...n]),console.log(n),v.success({content:s({en:"Load more success ",vi:"Táº£i thÃªm thÃ nh cÃ´ng "})+n.length})):v.info({content:s({en:"No more data",vi:"KhÃ´ng cÃ³ dá»¯ liá»‡u"})}),C(!1)},S=(n,e)=>{m("Posts:onChangeTime"),f(o=>j(o,i=>{const a=Array.isArray(e)?e[0]:e;i.beforeTime=new Date(a).getTime(),console.log(e,i.beforeTime)}))},W=n=>{m("Posts:onChangePostedBy:"+n),f(e=>j(e,o=>{o.postedByOthers=n}))},z=n=>{m("Posts:onChangePrivacy:"+n),f(e=>j(e,o=>{o.privacy=n}))},X=()=>{m("Posts:onToggleTaggedOnly"),f(n=>j(n,e=>{e.taggedInOnly=!e.taggedInOnly}))},q=async n=>{const e=n.target.value;if(m("Posts:onChangeUid:"+e),f(o=>j(o,i=>{i.uid=e})),!/^\d+$/.test(e)){const o=await oe(e);f(i=>j(i,a=>{a.uid=o}))}},H=async(n,e=!0)=>{if(e&&!await ae())return!1;const o="Posts:onDeletePost";m(o);const i=o+":"+n.id;return v.loading({key:i,content:s({en:"Deleting post..",vi:"Äang xoÃ¡ bÃ i viáº¿t.."}),duration:0}),await re(n.story_id)?(v.success({key:i,content:s({en:"Post deleted",vi:"XoÃ¡ bÃ i viáº¿t thÃ nh cÃ´ng"})}),w(r=>r.filter(l=>l.story_id!==n.story_id)),!0):(v.error({key:i,content:s({en:"Post not deleted",vi:"KhÃ´ng xoÃ¡ Ä‘Æ°á»£c bÃ i viáº¿t"})}),!1)},$=[{title:"#",key:"recent",dataIndex:"recent",sorter:(n,e)=>n.recent-e.recent,render:(n,e,o)=>e.recent+1,width:70,align:"center"},{title:s({en:"Actor",vi:"NgÆ°á»i Ä‘Äƒng"}),key:"actor",dataIndex:"actor",onSearch:(n,e,o)=>{var i,a;return O(n,(i=o==null?void 0:o.actor)==null?void 0:i.name)||O(n,(a=o==null?void 0:o.actor)==null?void 0:a.id)},render:(n,e,o)=>{var i,a,r,l,c,d;return t.jsxs(g,{style:{maxWidth:300},children:[t.jsx(me,{shape:"square",src:t.jsx(F,{src:te((i=e.actor)==null?void 0:i.id),fallback:(a=e.actor)==null?void 0:a.avatar}),size:50}),t.jsxs(g,{direction:"vertical",size:0,children:[t.jsx("a",{href:((r=e.actor)==null?void 0:r.url)||ne((l=e.actor)==null?void 0:l.id),target:"_blank",children:t.jsx("b",{children:(c=e.actor)==null?void 0:c.name})}),t.jsx("span",{style:{opacity:.5},children:(d=e.actor)==null?void 0:d.id})]})]})},width:250},{title:s({en:"Media",vi:"áº¢nh/Video"}),key:"media",dataIndex:"media",render:(n,e,o)=>{var c,d;const i=(c=e.content)==null?void 0:c.attachments,a=((d=i==null?void 0:i[0])==null?void 0:d.total_count)||(i==null?void 0:i.length),r=i.length===1,l=i.length===1&&i[0].type==="Video";return(i==null?void 0:i.length)>0?t.jsx(ie.Ribbon,{text:a,style:{display:i.length>1?"block":"none"},children:t.jsx(F,{src:i[0].thumbnail,style:{objectFit:"cover",height:150,width:210,borderRadius:10},preview:r&&!l?!0:{destroyOnClose:!0,imageRender:()=>l?t.jsx(ve,{info:{id:i[0].id}}):t.jsx(ge,{style:{maxWidth:"90vw",maxHeight:"90vh",alignItems:"center",overflowY:"auto",overflowX:"hidden",padding:20,borderRadius:10},children:t.jsx(fe,{target:e.actor,postId:e.url})}),toolbarRender:()=>null}})}):"-"},filters:[{text:s({en:"Video",vi:"Video"}),value:"video"},{text:s({en:"Has media",vi:"CÃ³ áº£nh hoáº·c video"}),value:"has-media"},{text:s({en:"Multi media",vi:"Nhiá»u áº£nh/video"}),value:"multi-media"}],onFilter:(n,e)=>{var o,i,a,r,l,c,d,P,T;if(n==="video")return((i=(o=e.content)==null?void 0:o.attachments)==null?void 0:i.length)===1&&((l=(r=(a=e.content)==null?void 0:a.attachments)==null?void 0:r[0])==null?void 0:l.type)==="Video";if(n==="has-media")return((d=(c=e.content)==null?void 0:c.attachments)==null?void 0:d.length)>0;if(n==="multi-media")return((T=(P=e.content)==null?void 0:P.attachments)==null?void 0:T.length)>1},width:200,align:"right"},{title:s({en:"Content",vi:"Ná»™i dung"}),key:"content",dataIndex:"content",onSearch:(n,e,o)=>{var i;return[(i=o.content)==null?void 0:i.text,o.message,o.title,o.summary].filter(Boolean).some(a=>O(n,a))},render:(n,e,o)=>{var a,r,l,c,d,P;const i=((a=e.content)==null?void 0:a.text)||((c=(l=(r=e.content)==null?void 0:r.attachments)==null?void 0:l.find(T=>T.title))==null?void 0:c.title);return t.jsxs(g,{direction:"vertical",style:{maxWidth:400},children:[((d=e.summary)==null?void 0:d.length)&&t.jsx(p.Text,{style:{fontStyle:"italic"},type:"secondary",children:I(e.summary,150)}),((P=e.message)==null?void 0:P.length)&&t.jsx(p.Text,{children:I(e.message,150)}),t.jsx(p.Text,{type:"secondary",children:I(i,150)})]})},width:"auto"},{title:s({en:"Posted time",vi:"ÄÄƒng lÃºc"}),key:"date",dataIndex:"date",sorter:(n,e)=>n.creation_time-e.creation_time,render:(n,e,o)=>t.jsxs(g,{direction:"vertical",size:0,children:[t.jsxs(p.Text,{children:[G(new Date(e.creation_time))," ",s({en:" ago",vi:"trÆ°á»›c"})]}),t.jsx(p.Text,{type:"secondary",children:Y(e.creation_time)})]})},{title:s({en:"Privacy",vi:"Quyá»n riÃªng tÆ°"}),key:"privacy",dataIndex:"privacy",render:(n,e,o)=>{const i=e.privacy.scope,a=e.privacy.description;return t.jsxs(g,{direction:"vertical",size:0,children:[t.jsx(p.Text,{children:s(N[i])}),a&&i===k.CUSTOM&&t.jsx(p.Text,{type:"secondary",children:a})]})},filters:Object.keys(k).map(n=>({text:s(N[n])+" ("+y.filter(e=>e.privacy.scope===n).length+")",value:n})),onFilter:(n,e)=>e.privacy.scope===n,width:150},{title:s({en:"Action",vi:"HÃ nh Ä‘á»™ng"}),key:"action",dataIndex:"action",render:(n,e,o)=>t.jsxs(g.Compact,{children:[e.can_delete&&t.jsx(h,{title:s({en:"Delete",vi:"XoÃ¡"}),children:t.jsx(ue,{title:s({en:"Are you sure to delete this post?",vi:"Báº¡n cÃ³ cháº¯c muá»‘n xoÃ¡ bÃ i viáº¿t nÃ y?"}),onConfirm:()=>{H(e)},children:t.jsx(x,{icon:t.jsx("i",{className:"fa-solid fa-trash"})})})}),t.jsx(h,{title:s({en:"Open in Bulk downloader",vi:"Má»Ÿ trong Táº£i hÃ ng loáº¡t"}),children:t.jsx(x,{onClick:()=>{E("/bulk-downloader",{state:{targetId:e.url,platform:Z.Facebook}})},icon:t.jsx("i",{className:"fa-solid fa-download"})})}),t.jsx(h,{title:s({en:"View on Facebook",vi:"Xem bÃ i viáº¿t"}),children:t.jsx(x,{onClick:()=>window.open(e.url,"_blank"),icon:t.jsx("i",{className:"fa-solid fa-up-right-from-square"})})})]}),width:150}],K=n=>{const e=n!=null&&n.length?n:y,o=e.filter(a=>a.can_delete),i=e.filter(a=>{var r;return(r=a.privacy)==null?void 0:r.can_edit});return t.jsxs(t.Fragment,{children:[t.jsxs(g.Compact,{children:[t.jsx(x,{loading:L,icon:t.jsx("i",{className:"fa-solid fa-play"}),onClick:V,children:s(L?{en:"Loading..",vi:"Äang táº£i.."}:{en:"Load more",vi:"Táº£i thÃªm"})}),t.jsx(de,{data:n.length?n:y,options:[{key:"json",label:".json",prepareData:a=>({fileName:"posts.json",data:JSON.stringify(a,null,4)})}]})]}),t.jsxs(g.Compact,{children:[o.length>0&&t.jsx(h,{title:s({en:"Coming soon",vi:"Sáº¯p cÃ³"}),children:t.jsxs(x,{disabled:!0,danger:!0,icon:t.jsx("i",{className:"fa-solid fa-trash"}),children:[s({en:"Delete",vi:"XoÃ¡"})," ",o.length]})}),i.length>0&&t.jsx(h,{title:s({en:"Coming soon",vi:"Sáº¯p cÃ³"}),children:t.jsxs(x,{disabled:!0,icon:t.jsx("i",{className:"fa-solid fa-lock"}),children:[s({en:"Change privacy",vi:"Sá»­a quyá»n riÃªng tÆ°"})," ",i.length]})})]})]})};return t.jsxs("div",{style:{display:"flex",flexDirection:"column",width:"100%",height:"100%"},children:[t.jsxs(xe,{align:"middle",style:{margin:"16px"},children:[t.jsx(p.Title,{level:3,style:{margin:0},children:s({en:"Posts manager",vi:"Quáº£n lÃ½ bÃ i viáº¿t"})}),t.jsx(se,{color:"error",style:{marginLeft:10},children:s({en:"ðŸš§ Work in progress",vi:"ðŸš§ Äang phÃ¡t triá»ƒn"})})]}),t.jsxs(g.Compact,{style:{marginBottom:10,marginLeft:5},children:[t.jsx(h,{title:s({en:"FB User",vi:"NgÆ°á»i dÃ¹ng FB"}),children:t.jsx(pe,{placeholder:s({en:"UID/URL",vi:"UID/URL"}),value:u.uid,onChange:q,style:{maxWidth:150}})}),t.jsx(h,{title:s({en:"Posted before time",vi:"ÄÄƒng trÆ°á»›c ngÃ y"}),children:t.jsx(ye,{value:u.beforeTime?le(u.beforeTime):null,onChange:S})}),t.jsx(h,{title:s({en:"Posted by",vi:"ÄÄƒng bá»Ÿi"}),children:t.jsxs(b,{style:{minWidth:120},value:u.postedByOthers,onChange:W,children:[t.jsx(b.Option,{value:null,children:s({en:"All",vi:"Táº¥t cáº£"})}),t.jsxs(b.Option,{value:!1,children:["ðŸ“Œ ",s({en:"Owner",vi:"ChÃ­nh chá»§"})]}),t.jsxs(b.Option,{value:!0,children:["ðŸ‘¤ ",s({en:"Others",vi:"NgÆ°á»i khÃ¡c"})]})]})}),t.jsx(h,{title:s({en:"Privacy",vi:"Quyá»n riÃªng tÆ°"}),children:t.jsx(b,{style:{minWidth:120},value:u.privacy,onChange:z,children:Object.keys(k).map(n=>t.jsx(b.Option,{value:n,children:s(N[n])},n))})}),t.jsx(h,{title:s({en:"Tagged only",vi:"Chá»‰ bÃ i viáº¿t Ä‘Æ°á»£c gáº¯n tháº»"}),children:t.jsx(x,{icon:t.jsx("i",{className:"fa-solid fa-user-tag"}),type:u.taggedInOnly?"primary":"default",onClick:X,children:s({en:"Tagged only",vi:"Gáº¯n tháº»"})})}),t.jsx(x,{type:"primary",onClick:U,icon:t.jsx("i",{className:"fa-solid fa-filter"}),children:s({en:"Apply",vi:"Lá»c"})})]}),t.jsx(ce,{data:M,columns:$,searchable:!0,selectable:!0,keyExtractor:n=>n.id,renderTitle:K})]})}export{Je as default};
