import{aA as $,as as nn,aB as en,aH as tn,r as I,aC as an,aJ as t,bk as on,ba as sn,b0 as cn,aL as v,b6 as B,b8 as L,b5 as P}from"./index-DKyUkP6l.js";import{k as U,p as R,y as rn,A as ln,z as hn,n as un,d as y,t as F,S as T,e as gn,g as mn,a as A,T as Y,B as dn}from"./MyApp-BDLwB7h-.js";import{M as bn}from"./MyTable-DVcLHhsv.js";import{E as kn}from"./ExportButton-BR4KCXKk.js";import{d as N}from"./dayjs.min-beU9NdAm.js";import{u as fn}from"./useAction-BRj3BQ1a.js";import{A as pn}from"./index-Cjn5nXrb.js";import{I as vn}from"./index-C7D-X_nD.js";import{P as O}from"./index-C_J4aFEf.js";import{R as yn}from"./row-D1L4EmjN.js";import{T as Tn}from"./index-DPRQSzuc.js";import{T as xn}from"./index-CBbw3ReW.js";import"./index-QWfpmwO1.js";import"./index-84eFfaCJ.js";import"./PurePanel-CqHWrtmI.js";import"./SearchOutlined-DIYILmvi.js";import"./Table-BLqj_5c7.js";import"./addEventListener-CXr0G5bM.js";import"./index-GK0vunuk.js";import"./index-8_b5udcl.js";import"./Dropdown-CVGqYSad.js";import"./useBreakpoint-DZFtf331.js";import"./responsiveObserver-BxjPScz9.js";import"./Pagination-fOL6YILi.js";import"./index-v1iB0WGq.js";import"./EyeOutlined-DTZsWLMy.js";import"./file-download-DIagG7Yu.js";import"./index-DNpzcib-.js";var u=(i=>(i.RESTRICTED_LIST="RESTRICTED_LIST",i.USER="USER",i.PAGE="PAGE",i.MESSAGE="MESSAGE",i.APP_INVITE="APP_INVITE",i.EVENT_INVITE="EVENT_INVITE",i))(u||{});const C={RESTRICTED_LIST:{icon:"fa-solid fa-ban",name:{en:"Restricted",vi:"Hạn chế"},desc:{en:`Restricted list:
When you add someone's profile to your Restricted list, they won't see posts on Facebook that you share only to Friends
They may still see things you share to Public or on a mutual friend's profile, and posts their profile is tagged in
Facebook doesn't notify your friends when you add them to your Restricted list.`,vi:`Danh sách hạn chế:
Khi bạn thêm trang cá nhân của ai đó vào Danh sách hạn chế thì trên Facebook, họ sẽ không nhìn thấy các bài viết mà bạn chỉ chia sẻ với Bạn bè
Họ có thể vẫn nhìn thấy nội dung bạn chia sẻ Công khai hoặc trên trang cá nhân của một người bạn chung cũng như các bài viết có gắn thẻ trang cá nhân của họ
Facebook không thông báo cho bạn bè của bạn khi bạn thêm họ vào Danh sách hạn chế.`}},USER:{icon:"fa-solid fa-user",name:{en:"User",vi:"Người dùng"},desc:{en:`Block users:
Once you block someone, that person can no longer see things you post on your timeline, tag you, invite you to events or groups, start a conversation with you, or add you as a friend
Note: Does not include apps, games or groups you both participate in.`,vi:`Chặn người dùng:
Khi bạn chặn ai đó, họ sẽ không xem được nội dung bạn đăng trên dòng thời gian của mình, gắn thẻ bạn, mời bạn tham gia sự kiện hoặc nhóm, bắt đầu cuộc trò chuyện với bạn hay thêm bạn làm bạn bè
Lưu ý: Điều này không bao gồm các ứng dụng, trò chơi hay nhóm mà cả bạn và người này đều tham gia.`}},PAGE:{icon:"fa-brands fa-facebook",name:{en:"Page",vi:"Trang"},desc:{en:`Block Pages:
Once you block a Page, that Page can no longer interact with your posts or like or reply to your comments
You'll be unable to post to the Page's timeline or message the Page
If you currently like the Page, blocking it will also unlike and unfollow it.`,vi:`Chặn Trang:
Sau khi bạn chặn một Trang, Trang đó sẽ không thể tương tác với bài viết của bạn hoặc thích, phản hồi bình luận của bạn nữa
Bạn sẽ không thể đăng lên dòng thời gian của Trang hoặc nhắn tin cho Trang
Nếu bạn đang thích Trang, việc chặn Trang cũng đồng nghĩa với bỏ thích và bỏ theo dõi Trang đó.`}},MESSAGE:{icon:"fa-brands fa-facebook-messenger",name:{en:"Message",vi:"Tin nhắn"},desc:{en:`Block messages:
If you block someone's profile on Facebook, they won't be able to contact you in Messenger either
Unless you block someone's Facebook profile and any others they may create, they may be able to post on your timeline, tag you, and comment on your posts or comments.`,vi:`Chặn tin nhắn:
Nếu bạn chặn trang cá nhân của ai đó trên Facebook, họ cũng sẽ không thể liên hệ với bạn trong Messenger
Nếu bạn không chặn trang cá nhân Facebook của ai đó và bất kỳ trang cá nhân nào khác họ có khả năng tạo, họ sẽ có thể đăng bài lên dòng thời gian của bạn, gắn thẻ bạn và bình luận về bài viết hoặc bình luận của bạn.`},confirm:{vi:`
Chặn tin nhắn và cuộc gọi
Thủy sẽ không bị chặn trên Facebook.
Bạn sẽ không nhận được tin nhắn hay cuộc gọi từ Thủy. Nếu bỏ chặn, bạn sẽ không nhận được bất kỳ nội dung nào mà người đó có thể đã gửi trong thời gian chặn.
Bạn và Thủy có thể nhìn thấy, nhắn tin và gọi cho nhau trong các nhóm chung, trừ khi bạn rời khỏi những nhóm đó.`}},APP_INVITE:{icon:"fa-brands fa-google-play",name:{en:"App invite",vi:"Ứng dụng"},desc:{en:`Block app invites:
Once you block app invites from someone's profile, you'll automatically ignore future app requests from that person's profile.`,vi:`Chặn lời mời cài đặt ứng dụng:
Sau khi chặn lời mời dùng ứng dụng từ trang cá nhân của người khác, bạn sẽ tự động bỏ qua các yêu cầu ứng dụng trong tương lai từ người đó.`}},EVENT_INVITE:{icon:"fa-regular fa-calendar",name:{en:"Event invite",vi:"Sự kiện"},desc:{en:`Block event invites:
Once you block event invites from someone’s profile, you’ll automatically ignore future event requests from that profile.`,vi:`Chặn lời mời tham gia sự kiện:
Khi bạn chặn lời mời tham gia sự kiện từ trang cá nhân của một người, bạn sẽ tự động bỏ qua những lời mời trong tương lai từ trang cá nhân đó.`}}};var H=(i=>(i.MALE="MALE",i.FEMALE="FEMALE",i.NEUTER="NEUTER",i.UNKNOWN="UNKNOWN",i))(H||{});const D={MALE:{color:"blue",en:"Male",vi:"Nam"},FEMALE:{color:"pink",en:"Female",vi:"Nữ"},NEUTER:{color:"orange",en:"Neuter",vi:"Trung tính"},UNKNOWN:{color:"default",en:"Unknown",vi:"Không xác định"}};async function En({type:i,cursor:g}){const m=g?await U({fb_api_req_friendly_name:"BlockingSettingsBlockingListPaginationQuery",variables:{count:10,cursor:g,profile_picture_size:36,id:btoa("privacy_block_setting:"+i.toString().toLocaleLowerCase())},doc_id:"5186554984768632"}):await U({fb_api_req_friendly_name:"BlockingSettingsDialogQuery",variables:{profile_picture_size:36,settingType:i},doc_id:"5425356630905390"}),s=R(m);console.log(s);const{edges:h=[],page_info:l}=$(s);return h.map(c=>{var b,x,k,E,_;return{type:i,id:(b=c==null?void 0:c.node)==null?void 0:b.id,name:(x=c==null?void 0:c.node)==null?void 0:x.name,avatar:(E=(k=c==null?void 0:c.node)==null?void 0:k.profile_picture)==null?void 0:E.uri,gender:((_=c==null?void 0:c.node)==null?void 0:_.gender)||"UNKNOWN",cursor:(c==null?void 0:c.cursor)||(l==null?void 0:l.end_cursor)}})}async function _n(){var s;const i=await rn(ln.EAAB);if(!i)return[];const g=await nn("https://graph.facebook.com/v21.0/me/blocked?fields=name,username,fbid,block_type,block_time&limit=100&access_token="+i);hn(g);const m=R(g);return((s=m==null?void 0:m.data)==null?void 0:s.map(h=>({id:h.fbid,name:h.name,time:new Date(h.block_time),isBlockMessage:h.block_type=="messenger"})))||[]}let Bn=0;async function Nn({id:i,type:g,value:m}){const s=m?"BLOCK":"UNBLOCK",h=await U({fb_api_req_friendly_name:"BlockingSettingsBlockMutation",variables:{input:{block_action:s,setting:g,target_id:i,actor_id:await un(),client_mutation_id:++Bn},profile_picture_size:36},doc_id:"6009824239038988"}),l=R(h);return en(l,"block_status")===s}function ee(){const{ti:i}=tn(),{onClickAction:g,onClickBulkActions:m}=fn(),[s,h]=y("Blocked.type",u.RESTRICTED_LIST),[l,c]=y("Blocked.data",{}),[b,x]=y("Blocked.loading",{}),[k,E]=y("Blocking.noData",{}),[_,K]=y("Blocked.blockTime",[]);I.useEffect(()=>{F("Blocked.onLoad"),_n().then(K)},[]);const q=n=>{F("Blocked:onChangeTab:"+n),h(n)},f=(n,e,a="")=>{x(o=>B(o,r=>{r[n+a]=e}))},G=(n,e)=>{c(a=>B(a,o=>{o[n]=e}))},V=(n,e)=>{c(a=>B(a,o=>{const r=o[n].findIndex(d=>d.id===e);return r>=0&&o[n].splice(r,1),o}))},S=(n,e)=>{E(a=>B(a,o=>{o[n]=e}))};I.useEffect(()=>{M(s)},[s]);const j=I.useRef({}),M=async(n,e=!1)=>{var r,d;if(!e&&(k[n]||j.current[n]||(r=l[n])!=null&&r.length))return;e&&S(n,!1),j.current[n]=!0,f(n,!0);const a=[];let o="";for(;;)try{o=((d=a[a.length-1])==null?void 0:d.cursor)||"";const p=await En({type:n,cursor:o});if(!(p!=null&&p.length)){a.length||S(n,!0);break}a.push(...p),console.log(a),G(n,[...a].map((Z,X)=>({...Z,isBlocked:!0,index:X+1}))),await an(500)}catch(p){console.log(p)}finally{}j.current[n]=!1,f(n,!1)},w=async n=>{f(s,!0,n.id);const e=await g({record:n,id:n.id,key:"Blocked:onClickUnblock",actionFn:()=>Nn({id:n.id,type:n.type,value:!1}),loadingText:()=>i({en:"Unblocking...",vi:"Đang bỏ chặn..."})+" "+n.name,successText:()=>i({en:"Unblocked",vi:"Đã bỏ chặn"})+" "+n.name,failedText:()=>i({en:"Failed to unblock",vi:"Lỗi bỏ chặn"})+" "+n.name,onSuccess:()=>{V(s,n.id)}});return f(s,!1,n.id),e},W=async n=>{f(s,!0);const e=await m({data:n,key:"Blocked:onClickUnblockBulk",actionFn:w,loadingText:()=>i({en:"Unblocking...",vi:"Đang bỏ chặn..."}),successText:()=>i({en:"Unblocked",vi:"Đã bỏ chặn"}),successDescItem:a=>a.name,requireVIP:!1});return f(s,!1),e},z=(n,e)=>L(n,e==null?void 0:e.name)||L(n,e==null?void 0:e.id),Q=n=>e=>t.jsxs(T,{children:[t.jsx(v,{disabled:b[n],type:"primary",icon:b[n]?t.jsx("i",{className:"fa-solid fa-rotate-right fa-spin"}):t.jsx("i",{className:"fa-solid fa-rotate-right"}),onClick:()=>M(n,!0),children:i({en:"Reload",vi:"Tải lại"})}),t.jsx(kn,{data:e!=null&&e.length?e:l[n]||[],options:[{key:"uid",label:".txt (friend uid)",prepareData:a=>({fileName:"friends_"+N().format("YYYY-MM-DD-HHmmss")+".txt",data:a.map(o=>o.id).join(`
`)})},{key:"uid_name",label:".csv (uid+name)",prepareData:a=>({fileName:"blocked_uid_name_"+N().format("YYYY-MM-DD-HHmmss")+".csv",data:P(a.map(o=>({uid:o.id,name:o.name})))})},{key:"json",label:".json",prepareData:a=>({fileName:"blocked"+N().format("YYYY-MM-DD-HHmmss")+".json",data:JSON.stringify(a,null,4)})},{key:"csv",label:".csv",prepareData:a=>({fileName:"blocked"+N().format("YYYY-MM-DD-HHmmss")+".csv",data:P(a)})}]}),(e==null?void 0:e.length)>0?t.jsx(O,{title:i(i({en:"Un-Block "+e.length+" users?",vi:"Bỏ chặn "+e.length+" người?"})),description:i({en:"Warning: After 48 hours, you can block again these users.",vi:"Lưu ý: Sau 48h mới có thể chặn lại những người này."}),onConfirm:()=>{W(e)},okText:i({en:"Unblock",vi:"Bỏ chặn"}),cancelText:i({en:"Cancel",vi:"Huỷ"}),children:t.jsx(v,{danger:!0,type:"default",icon:t.jsx("i",{className:"fa-regular fa-trash-can"}),children:i({en:"Unblock ",vi:"Bỏ chặn "})+e.length})}):null,t.jsx(Y,{title:i({en:"Coming soon",vi:"Sắp có"}),children:t.jsx(v,{disabled:!0,icon:t.jsx("i",{className:"fa-solid fa-plus"}),children:i({en:"Import",vi:"Chặn thêm"})})})]}),J=[{title:"#",key:"index",dataIndex:"index",width:50},{title:i({en:"Name",vi:"Tên"}),key:"nane",dataIndex:"name",render:(n,e,a)=>t.jsxs(T,{style:{maxWidth:300},children:[t.jsx(pn,{shape:"square",src:t.jsx(vn,{src:e.avatar,fallback:gn(e.id)}),size:50}),t.jsxs(T,{direction:"vertical",style:{marginLeft:"10px"},size:0,children:[t.jsx("a",{onClick:o=>{o.preventDefault();const r=mn(e.id);e.isBlocked&&[u.USER,u.PAGE].includes(e.type)?on(r):window.open(r,"_blank")},children:t.jsx("b",{children:e.name})}),t.jsx("span",{style:{opacity:.5},children:e.id})]})]}),width:"auto"},{title:i({en:"Gender",vi:"Giới tính"}),key:"gender",dataIndex:"gender",render:(n,e,a)=>{var o;return t.jsx(A,{color:((o=D[e.gender])==null?void 0:o.color)||"default",children:i(D[e.gender])||e.gender})},filters:Object.values(H).map(n=>{var e,a;return{text:i(D[n])+" ("+((a=(e=l[s])==null?void 0:e.filter(o=>o.gender===n))==null?void 0:a.length)+")",value:n}}),width:120},{title:i({en:"Time",vi:"Thời gian"}),key:"time",dataIndex:"time",render:(n,e,a)=>{var r;const o=(r=_.find(d=>d.id==e.id&&(d.isBlockMessage&&e.type==u.MESSAGE||!d.isBlockMessage&&[u.USER,u.PAGE,u.RESTRICTED_LIST].includes(e.type))))==null?void 0:r.time;return o?t.jsxs(T,{direction:"vertical",size:0,children:[sn(o),t.jsx("span",{style:{opacity:.5},children:cn(o)})]}):"-"},width:170},{title:i({en:"Status",vi:"Trạng thái"}),key:"isBlocked",dataIndex:"isBlocked",render:(n,e,a)=>e.isBlocked?t.jsx(A,{color:"red",children:i({en:"Blocked",vi:"Đang chặn"})}):t.jsx(A,{color:"green",children:i({en:"Unblocked",vi:"Bỏ chặn"})}),width:120},{title:i({en:"Action",vi:"Hành động"}),render:(n,e,a)=>t.jsx(O,{title:i(i({en:"Un-Block this user?",vi:"Bỏ chặn người này?"})),description:i({en:"Warning: After 48 hours, you can block again this user.",vi:"Lưu ý: Sau 48h mới có thể chặn lại người này."}),onConfirm:()=>{w(e)},okText:i({en:"Unblock",vi:"Bỏ chặn"}),cancelText:i({en:"Cancel",vi:"Huỷ"}),children:t.jsx(v,{loading:b[s+e.id],icon:t.jsx("i",{className:"fa-solid fa-ban"}),children:i({en:"Unblock",vi:"Bỏ chặn"})})}),width:120}];return t.jsxs(T,{direction:"vertical",style:{width:"100%"},children:[t.jsxs(yn,{align:"middle",style:{margin:"16px",marginBottom:0},children:[t.jsx(Tn.Title,{level:3,style:{margin:0,marginRight:10},children:i({en:"Blocked",vi:"Đang chặn"})}),t.jsx(v,{type:"default",icon:t.jsx("i",{className:"fa-solid fa-up-right-from-square"}),href:"https://www.facebook.com/settings/?tab=blocking",target:"_blank"})]}),t.jsx(xn,{defaultActiveKey:u.RESTRICTED_LIST,activeKey:s,onChange:q,items:Object.values(u).map(n=>{var e;return{key:n,label:t.jsxs(Y,{title:t.jsx(t.Fragment,{children:i(C[n].desc).split(`
`).map((a,o)=>t.jsx("p",{children:a},n+o))}),children:[b[n]?t.jsx("i",{className:"fa fa-spinner fa-spin"}):t.jsx("i",{className:C[n].icon})," ",i(C[n].name)," ",t.jsx(dn,{showZero:!0,count:k[n]?0:((e=l[n])==null?void 0:e.length)||"",color:k[n]?"gray":"purple",style:{color:"white"}})]}),children:t.jsx(bn,{columns:J,data:l[n],keyExtractor:a=>a==null?void 0:a.id,searchable:!0,selectable:!0,size:"small",onSearchRow:z,renderTitle:Q(n)})}})})]})}export{ee as default};
