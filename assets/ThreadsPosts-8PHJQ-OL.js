import{az as U,aG as V,r as w,aI as s,aK as H,cj as I,bk as K,ci as q}from"./index-CeJvQM_1.js";import{b as g}from"./core-BuNXBZRp.js";import{w as L,B as z,S as O}from"./MyApp-gHx8y6RU.js";import{f as W,a as A}from"./index-DFPUQD1k.js";import{i as D}from"./icons-Bc1aI4fF.js";import{C as X}from"./Collection-CN4Ilx2P.js";import{V as Y}from"./VideoWithMuted-BlCLxmva.js";import{S as G}from"./index-DmFiukgC.js";import{L as B}from"./index-DKX_kzRo.js";import{I as J}from"./index-wZc3PAP3.js";import"./videos-DBF5uo-A.js";import"./index-Df7Yaov-.js";import"./responsiveObserver-BSAfloFQ.js";import"./useBreakpoint-Dbe9Z3wZ.js";import"./index-yuZqtdD6.js";import"./index-DGLdIViO.js";import"./PurePanel-Bz4VSSOY.js";import"./index-DTe5rRoM.js";import"./EyeOutlined-twgbw0ak.js";import"./SearchOutlined-DgXilZwW.js";import"./index-CZlutG-j.js";import"./Dropdown-c1od-7ny.js";import"./Collapse-DzwED1aF.js";import"./index-BChavOtQ.js";import"./index-BKgApen7.js";import"./file-download-Cl0Yz8eU.js";import"./index-yTqhQKuY.js";import"./index-CRycMmR0.js";import"./index-B_eUwNXf.js";import"./Pagination-CujUnd4X.js";import"./row-CqwnU2ml.js";import"./addEventListener-CZQz616j.js";function Z(a,t){var m,f,d,j,r,_,c,l,u,i,p,h,y,x,C,T,k,N,P,S;const n=(f=(m=a==null?void 0:a.node)==null?void 0:m.thread_items)==null?void 0:f[0],e=((r=(j=(d=n==null?void 0:n.post)==null?void 0:d.text_post_app_info)==null?void 0:j.share_info)==null?void 0:r.reposted_post)||((l=(c=(_=n==null?void 0:n.post)==null?void 0:_.text_post_app_info)==null?void 0:c.share_info)==null?void 0:l.quoted_post)||(n==null?void 0:n.post);return{id:(u=a==null?void 0:a.node)==null?void 0:u.id,pk:e==null?void 0:e.pk,code:e==null?void 0:e.code,caption:(i=e==null?void 0:e.caption)==null?void 0:i.text,image:g((p=e==null?void 0:e.image_versions2)==null?void 0:p.candidates),video:g(e==null?void 0:e.video_versions),carousel:(h=e==null?void 0:e.carousel_media)==null?void 0:h.map(o=>{var b;return{id:o==null?void 0:o.id,pk:o==null?void 0:o.pk,code:o==null?void 0:o.code,accessibilityCaption:o==null?void 0:o.accessibility_caption,image:g((b=o==null?void 0:o.image_versions2)==null?void 0:b.candidates),video:g(o==null?void 0:o.video_versions),isCarouselItem:!0}}),audio:e==null?void 0:e.audio,createdTime:(e==null?void 0:e.taken_at)*1e3,mentions:(T=(C=(x=(y=e==null?void 0:e.text_post_app_info)==null?void 0:y.text_fragments)==null?void 0:x.fragments)==null?void 0:C.filter(o=>(o==null?void 0:o.fragment_type)==="mentrion"))==null?void 0:T.map(o=>{var b,E,F,Q;return{id:(E=(b=o==null?void 0:o.mention_fragment)==null?void 0:b.mentioned_user)==null?void 0:E.id,username:(Q=(F=o==null?void 0:o.mention_fragment)==null?void 0:F.mentioned_user)==null?void 0:Q.username,text:o==null?void 0:o.plaintext}}),likeCount:e==null?void 0:e.like_count,replyCount:(k=e==null?void 0:e.text_post_app_info)==null?void 0:k.direct_reply_count,repostCount:(N=e==null?void 0:e.text_post_app_info)==null?void 0:N.repost_count,quoteCount:(P=e==null?void 0:e.text_post_app_info)==null?void 0:P.quote_count,isGenAI:((S=e==null?void 0:e.gen_ai_detection_method)==null?void 0:S.detection_method)!="NONE",cursor:(a==null?void 0:a.cursor)||(t==null?void 0:t.end_cursor),raw:a}}var v=(a=>(a.Threads="Threads",a.Replies="Replies",a.Reposts="Reposts",a))(v||{});const R={Threads:{first:{name:"BarcelonaProfileThreadsTabQuery",doc_id:"8436285959793247"},withCursor:{name:"BarcelonaProfileThreadsTabRefetchableQuery",doc_id:"8921337961211543"}},Replies:{first:{name:"BarcelonaProfileRepliesTabQuery",doc_id:"8488857591189950"},withCursor:{name:"BarcelonaProfileRepliesTabRefetchableQuery",doc_id:"8562442443831413"}},Reposts:{first:{name:"BarcelonaProfileRepostsTabQuery",doc_id:"8425754140878176"},withCursor:{name:"BarcelonaProfileRepostsTabRefetchableQuery",doc_id:"9365308133484269"}}};async function $(a="",t="",n="Threads"){let e;if(t){const d=await W({fb_api_req_friendly_name:R[n].withCursor.name,variables:{after:t,before:null,first:10,last:null,userID:a,__relay_internal__pv__BarcelonaIsLoggedInrelayprovider:!0,__relay_internal__pv__BarcelonaIsInlineReelsEnabledrelayprovider:!1,__relay_internal__pv__BarcelonaOptionalCookiesEnabledrelayprovider:!0,__relay_internal__pv__BarcelonaShowReshareCountrelayprovider:!1,__relay_internal__pv__BarcelonaQuotedPostUFIEnabledrelayprovider:!1,__relay_internal__pv__BarcelonaIsCrawlerrelayprovider:!1,__relay_internal__pv__BarcelonaShouldShowFediverseM075Featuresrelayprovider:!0},doc_id:R[n].withCursor.doc_id});e=L(d)}else{const d=await W({fb_api_req_friendly_name:R[n].first.name,variables:{userID:a,__relay_internal__pv__BarcelonaIsLoggedInrelayprovider:!0,__relay_internal__pv__BarcelonaIsInlineReelsEnabledrelayprovider:!1,__relay_internal__pv__BarcelonaOptionalCookiesEnabledrelayprovider:!0,__relay_internal__pv__BarcelonaShowReshareCountrelayprovider:!1,__relay_internal__pv__BarcelonaQuotedPostUFIEnabledrelayprovider:!1,__relay_internal__pv__BarcelonaIsCrawlerrelayprovider:!1,__relay_internal__pv__BarcelonaShouldShowFediverseM075Featuresrelayprovider:!0},doc_id:R[n].first.doc_id});e=L(d)}console.log(e);const{edges:m=[],page_info:f={}}=U(e);return m.map(d=>Z(d,f))}const M={[v.Threads]:{en:"📝 Posts",vi:"📝 Posts"},[v.Replies]:{en:"💬 Replies",vi:"💬 Replies"},[v.Reposts]:{en:"🔁 Reposts",vi:"🔁 Reposts"}};function Se({target:a}){const{ti:t}=V(),[n,e]=w.useState(v.Threads),m=w.useCallback(async(r=[],_)=>{var l;return a!=null&&a.id?await $(a.id,_||((l=r[r.length-1])==null?void 0:l.cursor),n):void 0},[a,n]),f=w.useCallback((r,_)=>s.jsx(z,{count:t({en:"New",vi:"Mới"}),color:"purple",style:{color:"white"},children:s.jsx(G,{disabled:_,value:n,onChange:e,style:{width:"150px"},children:Object.entries(v).map(([c,l])=>s.jsx(G.Option,{value:l,children:t(M[l])},c))})}),[n,t]),d=w.useCallback(r=>{var i,p,h,y;const _=r.image||r.video||((i=r.carousel)==null?void 0:i.length),c="isCarouselItem"in r,l=c?null:s.jsx(H,{type:"default",icon:s.jsx("i",{className:"fa-solid fa-up-right-from-square"}),style:{position:"absolute",bottom:10,right:10},className:"show-on-hover-item",target:"_blank",href:A("@"+(a==null?void 0:a.id)+"/post/"+r.code)}),u=c?null:s.jsxs(O,{direction:"vertical",size:0,style:{position:"absolute",top:0,left:0,width:"100%",height:"100%",pointerEvents:"none",paddingTop:5,paddingLeft:10},children:[s.jsxs("span",{children:[s.jsx("i",{className:"fa fa-thumbs-up"})," ",I(r.likeCount)]}),s.jsxs("span",{children:[s.jsx("i",{className:"fa fa-comment"})," ",I(r.replyCount)]}),s.jsxs("span",{children:[s.jsx("i",{className:"fa fa-retweet"})," ",I(r.repostCount)]}),s.jsxs("span",{children:[s.jsx("i",{className:"fa fa-quote-left"})," ",I(r.quoteCount)]}),s.jsxs("span",{children:[s.jsx("i",{className:"fa fa-clock"})," ",K(new Date(r.createdTime))]})]});return _?s.jsxs(B.Item,{children:[s.jsxs("div",{className:"show-on-hover-trigger",children:[s.jsx(J,{src:r.image,width:250,height:250,style:{objectFit:"cover",borderRadius:10},preview:r.video||(p=r.carousel)!=null&&p.length?{destroyOnClose:!0,imageRender:()=>{var x;return(x=r.carousel)!=null&&x.length?s.jsx(O,{style:{maxWidth:"90vw",maxHeight:"90vh",alignItems:"center",overflowY:"auto",overflowX:"hidden",backgroundColor:"#111",padding:20,borderRadius:10},children:s.jsx(B,{grid:{gutter:10},style:{width:"100%"},dataSource:r.carousel,renderItem:d,rowKey:C=>C.id})}):s.jsx(Y,{src:r.video,style:{maxWidth:"90vw",maxHeight:"90vh"}})},toolbarRender:()=>null}:void 0}),l]}),s.jsx("p",{style:{wordWrap:"break-word",maxWidth:250,padding:5},title:r.caption,children:q(r.caption,80)}),s.jsx("div",{style:{position:"absolute",top:10,right:10,pointerEvents:"none"},children:((h=r.carousel)==null?void 0:h.length)>0?s.jsxs(s.Fragment,{children:[s.jsx("span",{children:(y=r.carousel)==null?void 0:y.length}),D.IGCarousel]}):r.video?D.IGVideo:null}),u]}):s.jsx(B.Item,{children:s.jsxs("div",{className:"show-on-hover-trigger",children:[s.jsx("div",{style:{width:250,height:250,display:"flex",justifyContent:"center",alignItems:"center"},children:s.jsx("p",{style:{wordWrap:"break-word",padding:5},title:r.caption,children:q(r.caption,200)})}),l,u]})})},[]),j=w.useCallback((r,_)=>{var l,u;if(!r.video&&!r.image&&((l=r.carousel)==null?void 0:l.length)===0)return[];function c(i,p=""){const h=!!i.video;return{url:h?i.video:i.image,name:p+i.id+(h?".mp4":".jpg")}}return((u=r.carousel)==null?void 0:u.length)>0?r.carousel.map((i,p)=>c(i,p+"_")):c(r)},[]);return a!=null&&a.username?s.jsx(X,{collectionName:(a==null?void 0:a.username)+" - Threads "+t(M[n]),fetchNext:m,renderItem:d,downloadItem:j,headerButtons:f,getItemCursor:r=>r.cursor||"",rowKey:r=>r.id}):null}export{Se as default};
